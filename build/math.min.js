/**
 *  Math JavaScript Library v3.0.0
 *  https://github.com/aantthony/javascript-cas
 *  
 * Copyright 2010 Anthony Foster. All rights reserved.
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */(function(e){"use strict";function n(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n}function r(e){var t=(new Error(e)).stack;if(!t)return console.warn("Deprecated: "+e);console.warn(t.replace(/^Error\: /,"Deprecated: "))}function o(t){function i(e,t,i){var s=[t,r++,i];if(typeof e=="object")for(var o=0;o<e.length;o++)n[e[o]]=s;else n[e]=s}var n={},r=0;t.forEach(function(t){i(t[0],t[1]||E,t[2]===e?2:t[2])}),this.operators=n,o.build.call(this)}function u(e){this.message=e}function h(){}function d(e,t){var n=x.parse(e,t);return n}function v(e,t){this.A=e||[],this.m=t||[]}function m(e){return e.__proto__=m.prototype,e}function g(e){}function N(e,t){return new d.Conditional(e.cond,t(e.a),t(e.b))}function C(e){this.x=e}function k(e){this.x=e}function M(e,t){this.pre=[]||t,this.s=e,this.vars=0,this.p=Infinity}function H(e,t){var n=d(e,t||H.Global);return n}var t,i=new Date,s=String.fromCharCode(215);t=o.prototype,t.precedence=function(e){if(!this.operators[e])throw"Precedence of "+e+" not known!";return this.operators[e][1]},t.postfix=function(e){var t=this.operators[e];return t[0]===0&&t[2]===1},t.unary=function(e){var t=["+","-","Â±"];return t.indexOf(e)!=-1?"@"+e:!1},t.assoc=function(e){return this.operators[e][1]===!0},t.Number=function(e){var t={0:l.Zero,1:l.One};if(t[e])return t[e];if(/^[\d]+$/.test(e))return new d.Integer(Number(e));if(/^[\d]*\.[\d]+$/.test(e)){var n=e.indexOf("."),r=e.length-n-1,i=Math.pow(10,r),s=Number(e.replace(".",""));return(new d.Rational(s,i)).reduce()}return t[e]||new d.NumericalReal(Number(e))},t=n(u,Error);var f={};f.Number=function(e){var t={0:l.Zero,1:l.One};if(t[e])return t[e];if(/^[\d]+$/.test(e))return new d.Integer(Number(e));if(/^[\d]*\.[\d]+$/.test(e)){var n=e.indexOf("."),r=e.length-n-1,i=Math.pow(10,r),s=Number(e.replace(".",""));return(new d.Rational(s,i)).reduce()}return t[e]||new d.NumericalReal(Number(e))},f.String=function(e){return e},f.Single=function(e){var t=Math.round(e);return t==e?new d.Integer(t):e};var l={},c=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,S:4,EOF:5,e:6,stmt:7,"=":8,"!=":9,"<=":10,"<":11,">":12,">=":13,csl:14,",":15,vector:16,"(":17,")":18,"+":19,"-":20,"*":21,"/":22,"POWER{":23,"}":24,"_{":25,_SINGLE:26,"SQRT{":27,"FRAC{":28,"{":29,"^SINGLE":30,identifier:31,number:32,IDENTIFIER:33,LONGIDENTIFIER:34,DECIMAL:35,INTEGER:36,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"=",9:"!=",10:"<=",11:"<",12:">",13:">=",15:",",17:"(",18:")",19:"+",20:"-",21:"*",22:"/",23:"POWER{",24:"}",25:"_{",26:"_SINGLE",27:"SQRT{",28:"FRAC{",29:"{",30:"^SINGLE",33:"IDENTIFIER",34:"LONGIDENTIFIER",35:"DECIMAL",36:"INTEGER"},productions_:[0,[3,2],[4,1],[4,1],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[14,3],[14,3],[16,3],[6,3],[6,3],[6,3],[6,3],[6,4],[6,4],[6,2],[6,3],[6,6],[6,2],[6,2],[6,2],[6,3],[6,1],[6,1],[6,1],[31,1],[31,1],[32,1],[32,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=o[a];break;case 3:this.$=o[a];break;case 4:this.$=["=",o[a-2],o[a]];break;case 5:this.$=["!=",o[a-2],o[a]];break;case 6:this.$=["<=",o[a-2],o[a]];break;case 7:this.$=["<",o[a-2],o[a]];break;case 8:this.$=[">",o[a-2],o[a]];break;case 9:this.$=[">=",o[a-2],o[a]];break;case 10:this.$=[",.",o[a-2],o[a]];break;case 11:this.$=[",",o[a-2],o[a]];break;case 12:this.$=o[a-1];break;case 13:this.$=["+",o[a-2],o[a]];break;case 14:this.$=["-",o[a-2],o[a]];break;case 15:this.$=["*",o[a-2],o[a]];break;case 16:this.$=["/",o[a-2],o[a]];break;case 17:this.$=["^",o[a-3],o[a-1]];break;case 18:this.$=["_",o[a-3],o[a-1]];break;case 19:this.$=["_",o[a-1],f.Single(t.substring(1))];break;case 20:this.$=["sqrt",o[a-1]];break;case 21:this.$=["frac",o[a-4],o[a-1]];break;case 22:this.$=["^",o[a-1],f.Single(t.substring(1))];break;case 23:this.$=["@-",o[a]];break;case 24:this.$=["default",o[a-1],o[a]];break;case 25:this.$=o[a-1];break;case 26:this.$=o[a];break;case 27:this.$=o[a];break;case 28:this.$=o[a];break;case 29:this.$=t;break;case 30:this.$=t.substring(1);break;case 31:this.$=f.Number(t);break;case 32:this.$=f.Number(t)}},table:[{3:1,4:2,6:3,7:4,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{1:[3]},{5:[1,16]},{5:[2,2],6:25,8:[1,26],9:[1,27],10:[1,28],11:[1,29],12:[1,30],13:[1,31],16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,2],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,3],24:[2,3]},{6:32,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:33,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:34,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:35,14:36,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,26],8:[2,26],9:[2,26],10:[2,26],11:[2,26],12:[2,26],13:[2,26],15:[2,26],17:[2,26],18:[2,26],19:[2,26],20:[2,26],21:[2,26],22:[2,26],23:[2,26],24:[2,26],25:[2,26],26:[2,26],27:[2,26],28:[2,26],30:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26]},{5:[2,27],8:[2,27],9:[2,27],10:[2,27],11:[2,27],12:[2,27],13:[2,27],15:[2,27],17:[2,27],18:[2,27],19:[2,27],20:[2,27],21:[2,27],22:[2,27],23:[2,27],24:[2,27],25:[2,27],26:[2,27],27:[2,27],28:[2,27],30:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27]},{5:[2,28],8:[2,28],9:[2,28],10:[2,28],11:[2,28],12:[2,28],13:[2,28],15:[2,28],17:[2,28],18:[2,28],19:[2,28],20:[2,28],21:[2,28],22:[2,28],23:[2,28],24:[2,28],25:[2,28],26:[2,28],27:[2,28],28:[2,28],30:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28]},{5:[2,29],8:[2,29],9:[2,29],10:[2,29],11:[2,29],12:[2,29],13:[2,29],15:[2,29],17:[2,29],18:[2,29],19:[2,29],20:[2,29],21:[2,29],22:[2,29],23:[2,29],24:[2,29],25:[2,29],26:[2,29],27:[2,29],28:[2,29],30:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29]},{5:[2,30],8:[2,30],9:[2,30],10:[2,30],11:[2,30],12:[2,30],13:[2,30],15:[2,30],17:[2,30],18:[2,30],19:[2,30],20:[2,30],21:[2,30],22:[2,30],23:[2,30],24:[2,30],25:[2,30],26:[2,30],27:[2,30],28:[2,30],30:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30]},{5:[2,31],8:[2,31],9:[2,31],10:[2,31],11:[2,31],12:[2,31],13:[2,31],15:[2,31],17:[2,31],18:[2,31],19:[2,31],20:[2,31],21:[2,31],22:[2,31],23:[2,31],24:[2,31],25:[2,31],26:[2,31],27:[2,31],28:[2,31],30:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31]},{5:[2,32],8:[2,32],9:[2,32],10:[2,32],11:[2,32],12:[2,32],13:[2,32],15:[2,32],17:[2,32],18:[2,32],19:[2,32],20:[2,32],21:[2,32],22:[2,32],23:[2,32],24:[2,32],25:[2,32],26:[2,32],27:[2,32],28:[2,32],30:[2,32],33:[2,32],34:[2,32],35:[2,32],36:[2,32]},{1:[2,1]},{6:37,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:38,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:39,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:40,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:41,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{4:42,6:3,7:4,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,19],8:[2,19],9:[2,19],10:[2,19],11:[2,19],12:[2,19],13:[2,19],15:[2,19],17:[2,19],18:[2,19],19:[2,19],20:[2,19],21:[2,19],22:[2,19],23:[2,19],24:[2,19],25:[2,19],26:[2,19],27:[2,19],28:[2,19],30:[2,19],33:[2,19],34:[2,19],35:[2,19],36:[2,19]},{5:[2,22],8:[2,22],9:[2,22],10:[2,22],11:[2,22],12:[2,22],13:[2,22],15:[2,22],17:[2,22],18:[2,22],19:[2,22],20:[2,22],21:[2,22],22:[2,22],23:[2,22],24:[2,22],25:[2,22],26:[2,22],27:[2,22],28:[2,22],30:[2,22],33:[2,22],34:[2,22],35:[2,22],36:[2,22]},{5:[2,24],6:25,8:[2,24],9:[2,24],10:[2,24],11:[2,24],12:[2,24],13:[2,24],15:[2,24],16:9,17:[1,8],18:[2,24],19:[2,24],20:[2,24],21:[2,24],22:[2,24],23:[1,21],24:[2,24],25:[2,24],26:[2,24],27:[2,24],28:[2,24],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:43,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:44,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:45,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:46,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:47,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:48,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,49],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,50],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,23],6:25,8:[2,23],9:[2,23],10:[2,23],11:[2,23],12:[2,23],13:[2,23],15:[2,23],16:9,17:[1,8],18:[2,23],19:[2,23],20:[2,23],21:[2,23],22:[2,23],23:[1,21],24:[2,23],25:[2,23],26:[2,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[1,52],16:9,17:[1,8],18:[1,51],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{15:[1,54],18:[1,53]},{5:[2,13],6:25,8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],15:[2,13],16:9,17:[1,8],18:[2,13],19:[2,13],20:[2,13],21:[1,19],22:[1,20],23:[1,21],24:[2,13],25:[2,13],26:[2,13],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,14],6:25,8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],15:[2,14],16:9,17:[1,8],18:[2,14],19:[2,14],20:[2,14],21:[2,23],22:[2,23],23:[1,21],24:[2,14],25:[2,14],26:[2,14],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,15],6:25,8:[2,15],9:[2,15],10:[2,15],11:[2,15],12:[2,15],13:[2,15],15:[2,15],16:9,17:[1,8],18:[2,15],19:[2,15],20:[2,15],21:[2,15],22:[2,15],23:[1,21],24:[2,15],25:[2,15],26:[2,15],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,16],6:25,8:[2,16],9:[2,16],10:[2,16],11:[2,16],12:[2,16],13:[2,16],15:[2,16],16:9,17:[1,8],18:[2,16],19:[2,16],20:[2,16],21:[2,16],22:[2,16],23:[1,21],24:[2,16],25:[2,16],26:[2,16],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,55],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{24:[1,56]},{5:[2,4],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,4],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,5],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,5],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,6],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,6],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,7],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,7],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,8],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,8],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,9],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,9],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,20],8:[2,20],9:[2,20],10:[2,20],11:[2,20],12:[2,20],13:[2,20],15:[2,20],17:[2,20],18:[2,20],19:[2,20],20:[2,20],21:[2,20],22:[2,20],23:[2,20],24:[2,20],25:[2,20],26:[2,20],27:[2,20],28:[2,20],30:[2,20],33:[2,20],34:[2,20],35:[2,20],36:[2,20]},{29:[1,57]},{5:[2,25],8:[2,25],9:[2,25],10:[2,25],11:[2,25],12:[2,25],13:[2,25],15:[2,25],17:[2,25],18:[2,25],19:[2,25],20:[2,25],21:[2,25],22:[2,25],23:[2,25],24:[2,25],25:[2,25],26:[2,25],27:[2,25],28:[2,25],30:[2,25],33:[2,25],34:[2,25],35:[2,25],36:[2,25]},{6:58,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],15:[2,12],17:[2,12],18:[2,12],19:[2,12],20:[2,12],21:[2,12],22:[2,12],23:[2,12],24:[2,12],25:[2,12],26:[2,12],27:[2,12],28:[2,12],30:[2,12],33:[2,12],34:[2,12],35:[2,12],36:[2,12]},{6:59,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,17],8:[2,17],9:[2,17],10:[2,17],11:[2,17],12:[2,17],13:[2,17],15:[2,17],17:[2,17],18:[2,17],19:[2,17],20:[2,17],21:[2,17],22:[2,17],23:[2,17],24:[2,17],25:[2,17],26:[2,17],27:[2,17],28:[2,17],30:[2,17],33:[2,17],34:[2,17],35:[2,17],36:[2,17]},{5:[2,18],8:[2,18],9:[2,18],10:[2,18],11:[2,18],12:[2,18],13:[2,18],15:[2,18],17:[2,18],18:[2,18],19:[2,18],20:[2,18],21:[2,18],22:[2,18],23:[2,18],24:[2,18],25:[2,18],26:[2,18],27:[2,18],28:[2,18],30:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18]},{6:60,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[2,11],16:9,17:[1,8],18:[2,11],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[2,10],16:9,17:[1,8],18:[2,10],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,61],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,21],8:[2,21],9:[2,21],10:[2,21],11:[2,21],12:[2,21],13:[2,21],15:[2,21],17:[2,21],18:[2,21],19:[2,21],20:[2,21],21:[2,21],22:[2,21],23:[2,21],24:[2,21],25:[2,21],26:[2,21],27:[2,21],28:[2,21],30:[2,21],33:[2,21],34:[2,21],35:[2,21],36:[2,21]}],defaultActions:{16:[2,1]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:break;case 1:return"TEXT";case 2:return 17;case 3:return 18;case 4:return 28;case 5:return 27;case 6:return 21;case 7:return 10;case 8:return 13;case 9:return"NE";case 10:return 34;case 11:return 33;case 12:return 35;case 13:return 36;case 14:return 8;case 15:return 21;case 16:return 21;case 17:return 22;case 18:return 20;case 19:return 19;case 20:return 10;case 21:return 13;case 22:return 11;case 23:return 12;case 24:return 9;case 25:return"&&";case 26:return 26;case 27:return 30;case 28:return 25;case 29:return 23;case 30:return"!";case 31:return"%";case 32:return 15;case 33:return"?";case 34:return":";case 35:return 17;case 36:return 18;case 37:return 29;case 38:return 24;case 39:return"[";case 40:return"]";case 41:return 5}},e.rules=[/^(?:\s+)/,/^(?:\$[^\$]*\$)/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\\frac\{)/,/^(?:\\sqrt\{)/,/^(?:\\cdot\b)/,/^(?:\\l[e])/,/^(?:\\g[e])/,/^(?:\\n[e])/,/^(?:\\[a-zA-Z]+)/,/^(?:[a-zA-Z])/,/^(?:[0-9]+\.[0-9]*)/,/^(?:[0-9]+)/,/^(?:=)/,/^(?:\*)/,/^(?:\.)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:<=)/,/^(?:>=)/,/^(?:<)/,/^(?:>)/,/^(?:!=)/,/^(?:&&)/,/^(?:_[^\(\{])/,/^(?:\^[^\(\{])/,/^(?:_\{)/,/^(?:\^\{)/,/^(?:!)/,/^(?:%)/,/^(?:,)/,/^(?:\?)/,/^(?::)/,/^(?:\()/,/^(?:\))/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:$)/],e.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=c,exports.Parser=c.Parser,exports.parse=function(){return c.parse.apply(c,arguments)},exports.main=function(t){if(!t[1])throw new Error("Usage: "+t[0]+" FILE");var n,r;return typeof process!="undefined"?n=require("fs").readFileSync(require("path").resolve(t[1]),"utf8"):n=require("file").path(require("file").cwd()).join(t[1]).read({charset:"utf-8"}),exports.parser.parse(n)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args)),t=h.prototype=Object.create(l),t.reset=function(){this.splice(0)},t.impliesExpression=function(e){return!1},t.learn=function(e){this.equations.push(e)},o.build=function(){this.parse=function(t,n){function u(e){i=Object.create(i);var t;for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t])}function a(e){return i=i.__proto__,e}function h(e){if(typeof e=="string"){var t;return(t=i[e])?t:((t=n[e])?o[e]=t:s[e]=t=new d.Symbol.Real(e),r[e]=t)}if(typeof e=="object"){var f=h(e[1]);if(e.length===3){switch(e[0]){case"frac":e[0]="/";break;case"_":if(e[1]==="sum"){var c=e[2];if(c[0]==="="){var p=new d.Symbol.Real(c[1]),v=h(c[2]),m=new d.Sum.Real(p,v);return m.vars={},m.vars[p.symbol]=p,m}}}if(e[0]==="default"&&f.vars){u(f.vars);var g=f[e[0]](h(e[2]));return delete g.vars,a(g)}return f[e[0]](h(e[2]))}if(e.length===2){switch(e[0]){case"sqrt":return l.sqrt.default(h(e[1]))}return h(e[1])[e[0]]()}if(e.length===4)return h(e[1])[e[0]](h(e[1]),h(e[2]))}return e}if(t==="")return e;var r=Object.create({}),i=r,s={},o={},f=!1,p=c.parse(t),v=h(p);v._ast=p;if(r!==i)throw"Context still open";return v.unbound=s,v.bound=o,v}},c.parseError=function(e,t){var n=new SyntaxError(e);throw n.line=t.line,n},c.lexer.next__=function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n){t=n,r=u;break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:(console.log("input",this._input),this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno}))},t=d.prototype,t.toString=null,t.valueOf=null,t.identity=function(){return r("Slow"),this},t.imageURL=function(){return"http://latex.codecogs.com/gif.latex?"+encodeURIComponent(this.s("text/latex").s)},t.renderLaTeX=function(){var e=new Image;return e.src=this.imageURL(),e},t.sub=function(){return this},t.lim=function(e,t){return this.sub(e,t)},t[","]=function(e){return e instanceof d.Statement?new d.Conditional(e,this):d.Vector([this,e])},t["="]=function(e){return new d.Statement(this,e,"=")},t["!="]=function(e){return new d.Statement(this,e,"!=")},t[">"]=function(e){return new d.Statement(this,e,">")},t[">="]=function(e){return new d.Statement(this,e,">=")},t["<"]=function(e){return new d.Statement(this,e,"<")},t["<="]=function(e){return new d.Statement(this,e,"<=")},t[s]=function(e){return this["*"](e)},t.default=function(e){return this["*"](e)},t["/"]=function(e){return new d.List([this,e],"/")},t["+"]=function(e){return new d.List([this,e],"+")},t["-"]=function(e){return new d.List([this,e],"-")},t["@-"]=function(e){return new d.List([this],"@-")},t["^"]=function(e){return new d.List([this,e],"^")},t["%"]=function(e){return new d.List([this,e],"%")},t["*"]=function(e){return e===l.Zero?e:e===l.One?this:new d.List([this,e],"*")},d.List=function(e,t){return e.__proto__=d.List.prototype,e.operator=t,e},t=n(d.List,d),t.sub=function(e,t){var n=this[0].sub(e,t);if(this.length===1)return n[this.operator]();var r=this[1].sub(e,t);return n[this.operator||"default"](r)},t["@-"]=function(){return this.operator==="@-"?this[0]:new d.List([this],"@-")},t=v.prototype,t.add=function(e){var t=this.A.indexOf(e);if(t===-1){var n=this.length;this.A[n]=e,this.m[n]=1}else this.m[t]++;return this},t.remove=function(e){var t=this.A.indexOf(e);return this.m[t]--,this},t.intersect=function(e){throw"What is multiset intersection?"},t.map=function(e){return v(Array.prototype.map.call(this.A,e),this.m)},v.fromArray=function(e){throw"NYI";var t,n},t=m.prototype,t.intersect=function(e){var t,n=this.length,r,i=e.length,s=new m([]);for(t=0;t<n;t++)for(r=0;r<i;r++){var o=this[t],u=e[r];if(o===u){s[s.length]=o;break}var a=o["-"](u);if(a===l.Zero){s[s.length]=o;break}}return o},t.union=function(e){return m(Array.prototype.concat.call(this,e))},t.remove=function(e){var t=this.indexOf(e);return this[t]=this[this.length-1],this.length--,this},t.add=function(e){return this.indexOf(e)===-1&&(this[this.length]=e),this},t.map=function(e){return m(Array.prototype.map.call(this,e))},t.compose=function(e){},t.cardinality=function(){return this.length},g.aleph_0={">":function(e){if(e instanceof d.NumericalReal)return d.True}},t=g.prototype=Object.create(m.prototype),t.cardinality=function(){return g.cardinality},d.TruthValue=function(t){},t=n(d.TruthValue,d),d.True=new d.TruthValue,d.False=new d.TruthValue,d.False["~"]=function(){return d.True},t["~"]=function(){return d.False},t.V=function(e){return e===d.True?e:this},t["^"]=function(e){return e===d.True?this:e},d.Statement=function(e,t,n){var r=[e,t];return r.operator=n,r.__proto__=d.Statement.prototype,r},t=exyend(d.Statement,d),t["="]=function(){},t["<"]=function(){},t.solve=function(e){var t=this.a["-"](this.b);return t.roots(e)};var b,w,E=b=0,S=w=1,x=new o([[";"],[","],[["=","+=","-=","*=","/=","%=","&=","^=","|="],S],[["?",":"],S,2],[["â¨"]],[["&&"]],[["|"]],[["??????"]],[["&"]],[["==","â ","!==","==="]],[["<","<=",">",">="],E],[[">>","<<"]],["Â±",S,2],[["+"],!0],[["-"],E],[["â«","â"],S,1],[["*","%"],S],[s,S],[["@+","@-","@Â±"],S,1],[["Â¬"],E,1],["default",S,2],["â",S,2],[["/"]],[["^"]],["!",E,1],[["~"],S,1],[["++","++",".","->"],E,1],[["::"]],[["_"],E,2],["var",S,1],["break",S,0],["throw",S,1],["'",E,1],["â",S,1],["#",S,1]]),T=new o([[";"],[","],[["=","+="]]]);d.Constant=function(){throw new Error("Expression.Constant created directly")},t=n(d.Constant,d),t.simplify=function(){return this},t.differentiate=function(){return l.Zero},t.default=function(e){return this["*"](e)},d.Symbol=function(t){this.symbol=t},t=n(d.Symbol,d),t.differentiate=function(e){return this===e?l.One:l.Zero},t.integrate=function(e){return this===e?(new d.NumericalReal(.5,0))["*"](e["^"](new d.NumericalReal(2,0))):this["*"](e)},t.sub=function(e,t){return this===e?t:this},d.Symbol.Real=function(t){this.symbol=t},t=d.Symbol.Real.prototype=Object.create(d.Symbol.prototype),t.constructor=d.Symbol.Real,t.realimag=function(){return d.List.ComplexCartesian([this,l.Zero])},t.real=function(){return this},t.imag=function(){return l.Zero},t.polar=function(){return d.List.ComplexPolar([d.List.Real([l.abs,this]),d.List.Real([l.arg,this])])},t.abs=function(){return d.List.Real([l.abs,this])},t.arg=function(){return d.List.Real([l.arg,this])},t["+"]=function(e){return e==l.Zero?this:e instanceof d.NumericalReal?new d.List.Real([this,e],"+"):e instanceof d.Symbol.Real?new d.List.Real([this,e],"+"):e instanceof d.Symbol?new d.List([this,e],"+"):e["+"](this)},t["-"]=function(e){return this===e?l.Zero:e instanceof d.Symbol.Real?new d.List.Real([this,e],"-"):e instanceof d.List.Real?e.operator==="@-"?new d.List.Real([this,e[0]],"+"):new d.List.Real([this,e],"-"):e instanceof d.Symbol?new d.List([this,e],"-"):e["@-"]()["+"](this)},t["@+"]=function(e){return d.List.Real([this],"@+")},t["@-"]=function(e){return d.List.Real([this],"@-")},t["*"]=function(e){return e instanceof d.Rational&&e.a===e.b?this:e instanceof d.Rational&&e.a===0?l.Zero:e instanceof d.Symbol.Real?new d.List.Real([this,e],"*"):e instanceof d.List.Real?e["*"](this):e instanceof d.Symbol?new d.List([this,e],"*"):e instanceof d.NumericalReal?new d.List.Real([e,this],"*"):e instanceof d.NumericalComplex?new d.List.Real([this,e],"*"):e instanceof d.List.ComplexCartesian?e["*"](this):e["*"](this)},t.default=t["*"],t["/"]=function(e){if(e instanceof d.Rational&&e.a===e.b)return this;if(e instanceof d.Rational&&e.a===0)throw"Division by zero";return d.List.Real([this,e],"/")},t["^"]=function(e){if(e instanceof d.Rational&&e.a===0)return l.One;if(e instanceof d.Rational&&e.a===e.b)return this;if(e instanceof d.Integer)return d.List.Real([this,e],"^");if(e instanceof d.Rational){var t=e.reduce();if(t.a%2===0)return d.List.Real([this,e],"^")}return d.List([this,e],"^")},t["%"]=function(e){return d.List.Real([this,e],"%")},t.apply=function(t,n){throw"Real.apply"},d.Function=function(e){this.default=e.default,this["text/latex"]=e["text/latex"],this["x-shader/x-fragment"]=e["x-shader/x-fragment"],this["text/javascript"]=e["text/javascript"],this.derivative=e.derivative,this.realimag=e.realimag},t=n(d.Function,d),t.default=function(e){return},t.differentiate=function(){if(this.derivative)return this.derivative;throw"Function has no derivative defined."},t._s=function(e){if(this[e])return new M(this[e]);throw"Could not compile function into "+e},t["+"]=function(e){var t=new d.Symbol;return new d.Function.Symbolic(this.default(t)["+"](e),[t])},t["@-"]=function(e){var t=new d.Symbol;return new d.Function.Symbolic(this.default(t)["@-"](),[t])},d.Function.Symbolic=function(t,n){this.expr=t,this.symbols=n},t=d.Function.Symbolic.prototype=Object.create(d.Function.prototype),t.constructor=d.Function.Symbolic,t.default=function(e){e.constructor!==d.Vector&&(e=d.Vector([e]));var t=this.expr,n,r=this.symbols.length;if(r!==e.length)throw"Invalid domain. Element of F^"+r+" expected.";for(n=0;n<r;n++)t=t.sub(this.symbols[n],e[n]);return t},d.NumericalComplex=function(e,t){this._real=e,this._imag=t},t=n(d.NumericalComplex,d.
Constant),t.real=function(){return new d.NumericalReal(this._real)},t.imag=function(){return new d.NumericalReal(this._imag)},t.realimag=function(){return d.List.ComplexCartesian([new d.NumericalReal(this._real),new d.NumericalReal(this._imag)])},t.conjugate=function(){return new d.NumericalComplex(this._real,-this._imag)},t["+"]=function(e){if(this._real===0&&this._imag===0)return e;if(e instanceof d.NumericalComplex)return new d.NumericalComplex(this._real+e._real,this._imag+e._imag);if(e instanceof d.NumericalReal)return new d.NumericalComplex(this._real+e.value,this._imag);if(e.constructor===d.List.ComplexCartesian)return e["+"](this);if(e.constructor===d.List.ComplexPolar)return e["+"](this);if(e.constructor===d.List.Real)return e["+"](this);if(e.constructor===d.Symbol.Real)return e["+"](this);if(e.constructor===d.List)return e["+"](this);throw"Unknown Type for NumericalComplex +"},t["-"]=function(e){if(this._real===0&&this._imag===0)return e["@-"]();if(e instanceof d.NumericalComplex)return new d.NumericalComplex(this._real-e._real,this._imag-e._imag);if(e.constructor===d.NumericalReal)return new d.NumericalComplex(this._real-e.value,this._imag);if(e.constructor===d.List.ComplexCartesian)return e["@-"]()["+"](this);if(e.constructor===d.List.ComplexPolar)return e["@-"]()["+"](this);if(e.constructor===d.List.Real)return e["@-"]()["+"](this);if(e.constructor===d.Symbol.Real)return e["@-"]()["+"](this);if(e.constructor===d.List)return e["@-"]()["+"](this);throw"Unknown Type for NumericalComplex -"},t["*"]=function(e){if(this._imag===0){if(this._real===0)return l.Zero;if(this._real===1)return e}if(e.constructor===this.constructor)return new d.NumericalComplex(this._real*e._real-this._imag*e._imag,this._real*e._imag+this._imag*e._real);if(e.constructor===d.NumericalReal)return new d.NumericalComplex(this._real*e.value,this._imag*e.value);if(e.constructor===d.List.ComplexCartesian)return e["*"](this);if(e.constructor===d.List.ComplexPolar)return e["*"](this);if(e.constructor===d.List.Real)return e["*"](this);if(e.constructor===d.Symbol.Real)return e["*"](this);if(e.constructor===d.List)return e["*"](this);throw"Unknown Type for NumericalComplex *"},t["/"]=function(e){if(this._imag===0&&this._real===0)return l.Zero;if(e.constructor===this.constructor){var t=e._real*e._real+e._imag*e._imag;return new d.NumericalComplex((this._real*e._real+this._imag*e._imag)/t,(this._imag*e._real-this._real*e._imag)/t)}if(e.constructor===d.NumericalReal)return new d.NumericalComplex(this._real/e.value,this._imag/e.value);if(e.constructor===d.List.ComplexCartesian)return this.realimag()["/"](e);if(e.constructor===d.List.ComplexPolar)return this.polar()["/"](e);if(e.constructor===d.List.Real)return d.List([this,e],"/");if(e.constructor===d.Symbol.Real)return d.List([this,e],"/");if(e.constructor===d.List)return d.List([this,e],"/");throw"Unknown Type for NumericalComplex /"},t["!"]=function(){return l.Gamma.default(this)},function(){return;var t}(),d.Conditional=function(t,n,r){if(n instanceof d.Symbol.Real||n instanceof d.List.Real)return new d.Conditional.Real(t,n,r);this.cond=t,this.a=n,this.b=r||l.undefined},t=n(d.Conditional,d),t.s=function(e){throw"Not real... too confusing"},t.real=function(e){return N(this,function(e){return e.real()})},t.imag=function(e){return N(this,function(e){return e.imag()})},t.realimag=function(e){return N(this,function(e){return e.realimag()})},t.differentiate=function(e){return N(this,function(t){return t.differentiate(e)})},d.Conditional.Real=function(t,n,r){this.cond=t,this.a=n,this.b=r||l.undefined},t=d.Conditional.Real.prototype=Object.create(d.Conditional.prototype),t.constructor=d.Conditional.Real,t.real=function(){return this},t.imag=function(){return l.Zero},t.realimag=function(){return new d.List.ComplexCartesian([this,l.Zero])},t.s=function(e){e==="text/latex";if(e==="text/javascript"||e=="x-shader/x-fragment"){var t=this.a.s(e),n=this.b.s(e);console.log("code",t,n);var r=this.cond.s(e),i=t.s,s=t.merge(n);return s.merge(r,"("+r.s+") ? "+i+" : "+n.s)}},d.prototype.conjugate=function(){throw"Conjugate"},d.List.prototype.conjugate=function(){var e,t=this.length,n=new Array(t);for(e=0;e<t;e++)n[e]=this[e].conjugate();return d.List(n,this.operator)},d.NumericalReal=function(t){this.value=t},t=n(d.NumericalReal,d.NumericalComplex),Object.defineProperty(t,"_real",{get:function(){return this.value}}),t._imag=0,t.real=function(){return this},t.imag=function(){return l.Zero},t.realimag=function(){return d.List.ComplexCartesian([this,l.Zero])},t.conjugate=function(){return this},t["+"]=function(e){return this.value===0?e:e instanceof d.NumericalReal?new d.NumericalReal(this.value+e.value):e["+"](this)},t["@-"]=function(e){return new d.NumericalReal(-this.value)},t["-"]=function(e){return this.value===0?e:e instanceof d.NumericalReal?new d.NumericalReal(this.value-e.value):e["@-"]()["+"](this)},t["%"]=function(e){var t="The modular arithmetic operator '%' is not defined for non-real numbers.";if(this.value===0)return l.Zero;if(e instanceof d.NumericalReal)return new d.NumericalReal(this.value%e.value);if(e.constructor===d.List.Real)return d.List.Real([this,e],"%");if(e.constructor===d.Symbol.Real)return d.List.Real([this,e],"%");throw e.constructor===d.List?"Not sure about this...":e.constructor===d.NumericalComplex?new TypeError(t):e.constructor===d.List.ComplexCartesian?new TypeError(t):e.constructor===d.List.ComplexPolar?new TypeError(t):"Unknown Type for NumericalReal %"},t["*"]=function(e){return e instanceof d.NumericalReal?new d.NumericalReal(this.value*e.value):e["*"](this)},t["/"]=function(e){if(this.value===0)return l.Zero;if(e instanceof d.NumericalReal){if(e.value===0)throw"Division by zero not allowed!";return new d.NumericalReal(this.value/e.value)}if(e.constructor===d.NumericalComplex){var t=e._real*e._real+e._imag*e._imag;return new d.Complex(this.value*e._real/t,-this.value*e._imag/t)}if(e instanceof d.List.ComplexCartesian){var n=d.List.ComplexCartesian([e[0],e[1]["@-"]()]),r=d.NumericalReal(2);return n["*"](this)["/"](e[0]["^"](r)["+"](e[1]["^"](r)))}if(!(e instanceof d.List.ComplexPolar)){if(e instanceof d.List.Real)return d.List.Real([this,e],"/");if(e instanceof d.Symbol.Real)return d.List.Real([this,e],"/");if(e instanceof d.List)return d.List([this,e],"/");throw console.log("Unknown type: ",this,e),"Unknown Type for NumericalReal /"}},t["^"]=function(e){if(this.value===0)return l.Zero;if(this.value===1)return l.One;if(e===l.Zero)return l.One;if(e===l.One)return this;if(e instanceof d.Integer)return new d.NumericalReal(Math.pow(this.value,e.a));if(e instanceof d.NumericalReal){if(this.value>0)return new d.NumericalReal(Math.pow(this.value,e.value));var t=Math.pow(-this.value,e.value),n=Math.PI*e.value;return new d.List.ComplexPolar([new d.NumericalReal(t),new d.NumericalReal(n)])}if(e.constructor===d.NumericalComplex){var r=this.value,i=e._real,s=e._imag;console.error("Bad implementation ( num ^ complex)");var o=.5*Math.log(r*r),u=o*s,a=Math.exp(o*i);return new d.NumericalComplex(a*Math.cos(u),a*Math.sin(u))}if(e.constructor===d.List.ComplexCartesian)return d.List([this,e],"^");if(e.constructor===d.List.ComplexPolar)return d.List([this,e],"^");if(e.constructor===d.List.Real)return this.value>0?d.List.Real([this,e],"^"):d.List([this,e],"^");if(e.constructor===d.Symbol.Real)return this.value>0?d.List.Real([this,e],"^"):d.List([this,e],"^");if(e.constructor===d.List)return d.List([this,e],"^");throw console.error("Unknown Type for NumericalReal ^",e,e instanceof d.NumericalReal)},t[">"]=function(e){return e instanceof d.NumericalReal?this.value>e.value?d.True:d.False:t.__proto__[">"].call(this,e)},t["<"]=function(e){return e instanceof d.NumericalReal?this.value<e.value?d.True:d.False:t.__proto__["<"].call(this,e)},t["<="]=function(e){return e instanceof d.NumericalReal?this.value<=e.value?d.True:d.False:t.__proto__["<="].call(this,e)},t[">="]=function(e){return e instanceof d.NumericalReal?this.value>=e.value?d.True:d.False:t.__proto__[">="].call(this,e)},t.apply=function(t,n){switch(t){case",":return d.Vector([this,n]);case"^":if(this.value===0)return l.Zero;break;case"+":if(this.value===0)return n;break;case"-":if(this.value===0)return n.apply("@-");break;case e:case"*":if(this.value===1)return n;case"/":if(this.value===0)return l.Zero}if(n===e)switch(t){case"@+":return this;case"@-":return new d.NumericalReal(-this.value);case"++":case"--":throw new TypeError("Postfix "+t+" operator applied to value that is not a reference.");case"+=":case"-=":case"*=":case"/=":throw new ReferenceError("Left side of assignment is not a reference.");case"!":return l.Gamma.apply(e,new d.NumericalReal(this.value+1))}else if(n.constructor===this.constructor)switch(t){case"*":case e:return new d.NumericalReal(this.value*n.value);case"+":return new d.NumericalReal(this.value+n.value);case"-":return new d.NumericalReal(this.value-n.value);case"/":return new d.NumericalReal(this.value/n.value);case"^":if(this.value>0)return new d.NumericalReal(Math.pow(this.value,n.value));var r=Math.pow(-this.value,n.value),i=Math.PI*n.value;return new d.Complex(r*Math.cos(i),r*Math.sin(i));default:}else if(n.constructor===d.Complex)switch(t){case"*":case e:return new d.Complex(this.value*n._real,this.value*n._imag);case"+":return new d.Complex(this.value+n._real,n._imag);case"-":return new d.Complex(this.value-n._real,-n._imag);case"/":var s=n._real*n._real+n._imag*n._imag;return new d.Complex(this.value*n._real/s,-this.value*n._imag/s);case"^":var o=this.value,u=n._real,a=n._imag;console.error("Bad implementation ( num ^ complex)");var f=.5*Math.log(o*o),c=f*a,h=Math.exp(f*u);return new d.Complex(h*Math.cos(c),h*Math.sin(c));default:}else if(n.constructor===d.List.ComplexCartesian)switch(t){case"+":case"-":return d.List.ComplexCartesian([n[0].apply(t,this),n[1]]);case e:t="*";case"*":case"/":return d.List.ComplexCartesian([n[0].apply(t,this),n[1].apply(t,this)]);case"^":return console.warn("ineffecient: NR ^ CL"),this.realimag().apply(t,n)}else if(n.constructor===d.List.ComplexPolar)switch(t){case"+":case"-":case"^":return d.List([this,n],t);case e:t="*";case"*":return d.List.ComplexPolar([n[0].apply(t,this),n[1]]);case"/":return d.List.ComplexPolar([n[0].apply(t,this),n[1]])}else if(n.constructor===d.List.Real)switch(t){case e:t="*";case"*":case"+":case"-":case"/":return d.List.Real([this,n],t);case"^":if(this.value===0)throw"N(0) ^ x";return this.value>0?d.List.Real([this,n],t):d.List.ComplexPolar([(new d.Numerical(-this.value)).apply("^",n),l.pi.apply("*",n)])}else if(n.constructor===d.Symbol.Real)switch(t){case e:t="*";case"*":case"+":case"-":case"/":return d.List.Real([this,n],t);case"^":if(this.value===0)throw"N(0) ^ x";return this.value>0?d.List.Real([this,n],t):d.List.ComplexPolar([d.List.Real([new d.NumericalReal(-this.value),n],"^"),l.pi.apply("*",n)])}throw"?? - real"},d.Rational=function(t,n){this.a=t,this.b=n},t=n(d.Rational,d.NumericalReal),t.__defineGetter__("value",function(){return this.a/this.b}),t["+"]=function(e){return this.a===0?e:e instanceof d.Rational?new d.Rational(this.a*e.b+this.b*e.a,this.b*e.b):e.constructor===d.NumericalComplex?new d.NumericalComplex(this.value+e._real,e._imag):e.constructor===d.List.ComplexCartesian?e["+"](this):e.constructor===d.List.ComplexPolar?e["+"](this):e.constructor===d.List.Real?e["+"](this):e.constructor===d.Symbol.Real?e["+"](this):e.constructor===d.List?e["+"](this):(console.warn("Swapped operator order for + with Rational"),e["+"](this))},t["-"]=function(e){return this.a===0?e["@-"]():e instanceof d.Rational?new d.Rational(this.a*e.b-this.b*e.a,this.b*e.b):e.constructor===d.NumericalComplex?new d.NumericalComplex(this.value-e._real,e._imag):e.constructor===d.List.ComplexCartesian?e["@-"]()["+"](this):e.constructor===d.List.ComplexPolar?e["@-"]()["+"](this):e.constructor===d.List.Real?e["@-"]()["+"](this):e.constructor===d.Symbol.Real?e["@-"]()["+"](this):e.constructor===d.List?e["@-"]()["+"](this):(console.warn("Swapped operator order for - with Rational"),e["+"](this))},t["*"]=function(e){return this.a===0?l.Zero:e instanceof this.constructor?new d.Rational(this.a*e.a,this.b*e.b):this.__proto__.__proto__["*"].call(this,e)},t["/"]=function(e){if(this.a===0)return l.Zero;if(e instanceof this.constructor){if(e.a===0)throw"Division By Zero is not defined for Rational numbers!";return(new d.Rational(this.a*e.b,this.b*e.a)).reduce()}return d.NumericalReal.prototype["/"].call(this,e)},t["^"]=function(e){if(e===l.Zero)return l.One;if(e===l.One)return this;if(this.a===0)return l.Zero;if(this.a===this.b)return l.One;if(e instanceof d.Integer)return new d.Rational(Math.pow(this.a,e.a),Math.pow(this.b,e.a));if(e instanceof d.Rational){var t=e.reduce();return t.a%2==0?new d.NumericalReal(Math.pow(Math.pow(this.a,t.a),1/t.b)):d.NumericalReal.prototype["^"].call(this,e)}return d.List([this,e],"^")},t.reduce=function(){function e(t,n){return n===0?t:e(n,t%n)}var t=e(this.b,this.a);return this.a/=t,this.b/=t,this.b===1?new d.Integer(this.a):(this.b<0&&(this.a=-this.a,this.b=-this.b),this)},d.Integer=function(t){this.a=t},t=n(d.Integer,d.Rational),t.b=1,t["+"]=function(e){return e instanceof d.Integer?new d.Integer(this.a+e.a):e["+"](this)},t["-"]=function(e){return e instanceof d.Integer?new d.Integer(this.a-e.a):this.__proto__.__proto__["-"].call(this,e)},t["/"]=function(e){return e instanceof d.Integer?this.a%e.a===0?new d.Integer(this.a/e.a):new d.Rational(this.a,e.a):this.__proto__.__proto__["/"].call(this,e)},t["@-"]=function(){return new d.Integer(-this.a)},t["*"]=function(e){return e instanceof d.Integer?new d.Integer(this.a*e.a):e["*"](this)},t["^"]=function(e){if(e instanceof d.Integer)return new d.Integer(Math.pow(this.a,e.a));if(e.constructor===d.Rational){var t=e.reduce();return t.a%2==0?new d.NumericalReal(Math.pow(Math.pow(this.a,t.a),1/t.b)):d.NumericalReal.prototype["^"].call(this,e)}if(e.constructor===d.List.Real||e.constructor===d.Symbol.Real)if(this.a>0)return d.List.Real([this,e],"^");return d.NumericalReal.prototype["^"].call(this,e)},t["%"]=function(e){return e instanceof d.Integer?new d.Integer(this.a%e.a):e.constructor===d.Rational?new d.Rational:e.constructor===d.NumericalReal?new d.NumericalReal(this%e.value):d.List.Real([this,e],"%")},d.List.prototype.differentiate=function(t){switch(this.operator){case e:if(this[0]instanceof d.Function){var n=this[1].differentiate(t);return n===l.Zero?n:this[0].differentiate().default(this[1])["*"](n)};case"*":return this[0].differentiate(t)["*"](this[1])["+"](this[1].differentiate(t)["*"](this[0]));case"@+":case"@-":return this[0].differentiate(t)[this.operator]();case"+":case"-":return this[0].differentiate(t)[this.operator](this[1].differentiate(t));case"^":var r=this[0].differentiate(t),i=this[1].differentiate(t);if(r===l.Zero)return i===l.Zero?l.Zero:i["*"](l.log.default(this[0]))["*"](this);var s=this[0]["^"](this[1]["-"](l.One));return s["*"](r["*"](this[1])["+"](this[0]["*"](l.log.default(this[0]))["*"](i)));case"/":var n=this[0].differentiate(t),o=this[1].differentiate(t);if(o===l.Zero)return n["/"](this[1]);return this[1]["*"](n)["-"](this[0]["*"](o))["/"](this[1]["^"](new d.Integer(2)));default:throw"Cannot differentiate "+this.operator+" operator."}},d.prototype.differentiateN=function(e,t){if(t===0)return this;if(t<=-1)return this.integrateN(e,t);if(t>1)return this.differentiate(e).differentiateN(e,t-1);if(t===1)return this.differentiate(e)},d.Root=function(t,n){this.a=t,this.n=n},t=d.Root.prototype=Object.create(d.NumericalReal),t.constructor=d.Root,t["*"]=function(e){if(e.constructor!==this.constructor)return e["*"](this)},t.__defineGetter__("value",function(){return Math.pow(this.a,1/this.n)}),d.Equation=function(e,t){return e.__proto__=d.Equation.prototype,e.operator=t,e},t=d.Equation.prototype=Object.create(d.List.prototype),t.apply=function(e,t){throw"Operators cannot be applied to equations"},d.List.ComplexPolar=function(e){return e.__proto__=d.List.ComplexPolar.prototype,e},t=n(d.List.ComplexPolar,d),t.polar=function(){return this},t.realimag=function(){return d.List.ComplexCartesian([this[0].apply("*",l.cos.apply(e,this[1])),this[0].apply("*",l.sin.apply(e,this[1]))])},t.real=function(){return this[0].apply("*",l.cos.apply(e,this[1]))},t.imag=function(){return this[0].apply("*",l.sin.apply(e,this[1]))},t.conjugate=function(){return d.List.ComplexPolar([this[0],this[1].apply("@-")])},t.differentiate=function(e){return l.e.apply("^",l.i.apply("*",this[1])).apply("*",this[0].differentiate(e).apply("+",l.i.apply("*",this[0]).apply("*",this[1].differentiate(e))))},t.apply=function(t,n){if(n.constructor===this.constructor)switch(t){case e:case"*":return d.List.ComplexPolar([this[0].apply("*",n[0]),this[1].apply("+",n[1])]);case"/":return d.List.ComplexPolar([this[0].apply("/",n[0]),this[1].apply("-",n[1])]);case"+":case"-":case"^":case"!":default:}else if(n.constructor===d.NumericalReal)switch(t){case e:case"*":return d.List.ComplexPolar([this[0].apply("*",n),this[1]]);case"/":return d.List.ComplexPolar([this[0].apply("/",n),this[1]]);case"+":case"-":case"^":return d.List.ComplexPolar([this[0],this[1].apply("*",n)]);case"!":default:}else if(n.constructor===d.Complex)switch(t){case e:case"*":return d.List.ComplexPolar([this[0].apply("*",new d.NumericalReal(n._real)),this[1].apply("+",new d.NumericalReal(n._imag))]);case"/":return d.List.ComplexPolar([this[0].apply("/",new d.NumericalReal(n._real)),this[1].apply("-",new d.NumericalReal(n._imag))]);case"+":case"-":case"^":case"!":default:}},t.abs=function(){return this[0]},t.arg=function(){return this[1]},d.prototype.real=function(){return console.warn("TODO: don't calculate both parts (Expression.prototype.real)"),this.realimag()[0]},d.prototype.imag=function(){return console.warn("TODO: don't calculate both parts (Expression.prototype.imag)"),this.realimag()[1]},d.List.prototype.realimag=function(){console.error("Only the user can call this function");switch(this.operator){case e:if(this[0]instanceof d.Function)return this[0].realimag().default(this[1]);case"*":var t=this[0].realimag(),n=this[1].realimag();return d.List.ComplexCartesian([t[0]["*"](n[0])["-"](t[1]["*"](n[1])),t[0]["*"](n[1])["+"](t[1]["*"](n[0]))]);case"@+":case"@-":var t=this[0].realimag();return d.List.ComplexCartesian([t[0][this.operator](),t[1][this.operator]()]);case"+":case"-":var t=this[0].realimag(),n=this[1].realimag();return d.List.ComplexCartesian([t[0][this.operator](n[0]),t[1][this.operator](n[1])]);case"/":var t=this[0].realimag(),n=this[1].realimag(),r=n[0]["*"](n[0])["+"](n[1]["*"](n[1]));return d.List.ComplexCartesian([t[0]["*"](n[0])["+"](t[1]["*"](n[1]))["/"](r),t[1]["*"](n[0])["-"](t[0]["*"](n[1]))["/"](r)]);case"^":var t=this[0].realimag(),n=this[1].realimag(),i=new d.Rational(1,2),s=new d.Integer(2),o=l.log.realimag().default(t),u=o[0],a=o[1],f=u["*"](n[1])["+"](a["*"](n[0])),c=l.e["^"](u["*"](n[0])["-"](a["*"](n[1])));return d.List.ComplexCartesian([c["*"](l.cos.default(f)),c["*"](l.sin.default(f))])}},d.List.ComplexCartesian=function(t){return t.__proto__=d.List.ComplexCartesian.prototype,t},t=n(d.List.ComplexCartesian,d),t.realimag=function(){return this},t.real=function(){return this[0]},t.imag=function(){return this[1]},t.conjugate=function(){return d.List.ComplexCartesian([this[0],this[1].apply("@-")])},t["@-"]=function(e){return new d.List.ComplexCartesian([this[0]["@-"](),this[1]["@-"]()])},t["*"]=function(e){if(e instanceof d.List.ComplexCartesian)return new d.List.ComplexCartesian([this[0]["*"](e[0])["-"](this[1]["*"](e[1])),this[0]["*"](e[1])["+"](this[1]["*"](e[0]))]);if(e instanceof d.List.Real||e instanceof d.Symbol.Real||e instanceof d.NumericalReal)return new d.List.ComplexCartesian([this[0]["*"](e),this[1]["*"](e)])},t["^"]=function(e){if(e instanceof d.Integer){if(e instanceof d.Rational&&e.a===e.b)return this;if(e instanceof d.Rational&&e.a===0)return l.One;var t=e.a,n,e=this[0],r=this[1],i=new d.Integer(-1),s=l.Zero,o=e["^"](new d.Integer(t)),u=1;for(n=1;;n++){if(n===t){var a=r["^"](new d.Integer(n));u===0?o=o["+"](a):u===1?s=s["+"](a):u===2?o=o["-"](a):u===3&&(s=s["-"](a),u=-1);break}var a=e["^"](new d.Integer(t-n))["*"](r["^"](new d.Integer(n)));u===0?o=o["+"](a):u===1?s=s["+"](a):u===2?o=o["-"](a):u===3&&(s=s["-"](a),u=-1),u++}return new d.List.ComplexCartesian([o,s])}return new d.List([this,e],"^")},t["+"]=function(e){if(e instanceof d.List.ComplexCartesian)return new d.List.ComplexCartesian([this[0]]);if(e instanceof d.List.Real||e instanceof d.Symbol.Real||e instanceof d.NumericalReal)return new d.List.ComplexCartesian([this[0]["+"](e),this[1]])},t.differentiate=function(e){return d.List.ComplexCartesian([this[0].differentiate(e),this[1].differentiate(e)])},t.apply=function(t,n){if(n.constructor===this.constructor)switch(t){case"+":case"-":return d.List.ComplexCartesian([this[0].apply(t,n[0]),this[1].apply(t,n[1])]);case e:case"*":return d.List.ComplexCartesian([this[0].apply("*",n[0]).apply("-",this[1].apply("*",n[1])),this[0].apply("*",n[1]).apply("+",this[1].apply("*",n[0]))]);case"/":var r=n[0].apply("*",n[0]).apply("+",n[1].apply("*",n[1]));return d.List.ComplexCartesian([this[0].apply("*",n[0]).apply("+",this[1].apply("*",n[1])).apply("/",r),this[1].apply("*",n[0]).apply("-",this[0].apply("*",n[1])).apply("/",r)]);case"^":var i=new d.NumericalReal(.5,0),s=i.apply("*",l.log.apply(e,this[0].apply("*",this[0]).apply("+",this[1].apply("*",this[1])))),o=l.atan2.apply(e,d.Vector([this[1],this[0]])),u=s.apply("*",n[1]).apply("+",o.apply("*",n[0])),f=l.e.apply("^",s.apply("*",n[0]).apply("-",o.apply("*",n[1])));return d.List.ComplexCartesian([f.apply("*",l.cos.apply(e,u)),f.apply("*",l.sin.apply(e,u))]);case"!":default:}else if(n.constructor===d.List.ComplexPolar)switch(t){case"*":case"/":var r=n[0].apply("*",n[0]),c=n.realimag();return d.List.ComplexCartesian([this[0].apply("*",c[0]).apply("+",a[1].apply("*",c[1])).apply("/",r),this[1].apply("*",c[0]).apply("-",a[0].apply("*",c[1])).apply("/",r)]);case"^":case"+":case"-":return this.apply(t,n.realimag())}else{if(n.constructor===d.Complex)return this.apply(t,n.realimag());if(n.constructor===d.Symbol.Real)return console.error("Duplicated an x! This makes it difficult to solve complex equations, I think"),this.apply(t,n.realimag());if(n.constructor===d.List.Real)return console.error("Duplicated an x! This makes it difficult to solve complex equations, I think"),this.apply(t,n.realimag())}throw"CMPLX.LIST * "+t},d.List.Real=function(n,r){return n.__proto__=d.List.Real.prototype,r!==e&&(n.operator=r),n},t=n(d.List.Real,d.List),t.realimag=function(){return d.List.ComplexCartesian([this,l.Zero])},t.real=function(){return this},t.imag=function(){return l.Zero},t.polar=function(){return d.List.ComplexPolar([d.List.Real([l.abs,this]),d.List.Real([l.arg,this])])},t.abs=function(){return d.List.Real([l.abs,this])},t.arg=function(){return d.List.Real([l.arg,this])},t["+"]=function(e){return this===e?e["*"](new d.Integer(2)):e instanceof d.Rational&&e.a===0?this:e instanceof d.NumericalReal?this.operator==="+"&&this[1]instanceof d.NumericalReal?d.List.Real([this[0],this[1]["+"](e)],this.operator):this.operator==="-"&&this[1]instanceof d.NumericalReal?d.List.Real([this[0],e["-"](this[1])],"+"):d.List.Real([this,e],"+"):e instanceof d.List.Real||e instanceof d.Symbol.Real?d.List.Real([this,e],"+"):e["+"](this)},t["-"]=function(e){return e instanceof d.Rational&&e.a===0?this:e===this?l.Zero:e instanceof d.List.Real?e.operator==="@-"?d.List.Real([this,e[0]],"+"):d.List.Real([this,e],"-"):e instanceof d.Symbol.Real||e instanceof d.NumericalReal?d.List.Real([this,e],"-"):this.realimag()["-"](e)},t["*"]=function(e){return e instanceof d.Rational&&e.a===e.b?this:e instanceof d.Rational&&e.a===0?l.Zero:e instanceof d.NumericalReal?this.operator==="*"||this.operator==="/"&&this[0]instanceof d.NumericalReal?d.List.Real([this[0]["*"](e),this[1]],this.operator):d.List.Real([e,this],"*"):e instanceof d.List.Real||e instanceof d.Symbol.Real?(this[0]instanceof d.Function,d.List.Real([this,e],"*")):e["*"](this)},t["/"]=function(e){return e instanceof d.Rational&&e.a===e.b?this:e===this?l.One:e instanceof d.NumericalReal?this.operator==="*"||this.operator==="/"?d.List.Real([this[0]["/"](e),this[1]],this.operator):d.List.Real([this,e],"/"):e instanceof d.List.Real||e instanceof d.Symbol.Real?d.List.Real([this,e],"/"):this.realimag()["/"](e)},t["%"]=function(e){return d.List.Real([this,e],"%")},t["@-"]=function(){return this.operator==="@-"?this[0]:d.List.Real([this],"@-")},t["^"]=function(e){if(e instanceof d.NumericalReal)if(this.operator==="*"||this.operator==="/"&&this[0]instanceof d.NumericalReal)return d.List.Real([this[0]["^"](e),this[1]["^"](e)],this.operator);return d.Symbol.Real.prototype["^"].call(this,e)},d.prototype.polar=function(){var e=this.realimag(),t=new d.Integer(2);return d.List.ComplexPolar([l.sqrt.default(e[0]["^"](t)["+"](e[1]["^"](t))),l.atan2.default(d.Vector([e[1],e[0]]))])},d.prototype.abs=function(){console.warn("SLOW?");var e=this.realimag(),t=new d.Integer(2);return l.sqrt.default(e[0]["^"](t)["+"](e[1]["^"](t)))},d.prototype.arg=function(){console.warn("Slow?");var e=this.realimag();return l.atan2.default(d.Vector([e[1],e[0]]))},d.prototype.factors=function(e,t,n){n(this,!1)},d.prototype.terms=function(e,t,n){n(this,!1)},d.prototype.factorize=function(e){throw"Inefficent";var t,n},d.Symbol.Real.prototype.factors=function(e,t,n){e.indexOf(this)!==-1?t(this,!1):n(this,!1)},d.Symbol.Real.prototype.terms=function(e,t,n){e.indexOf(this)!==-1?t(this,!1):n(this,!1)},d.List.Real.prototype.terms=function(e,t,n){switch(this.operator){case"+":this[0].terms(e,t,n),this[1].terms(e,t,n);return;case"-":this[0].terms(e,t,n),this[1].terms(e,function(e){t(e["@-"]())},function(e){n(e["@-"]())});return;case"*":var r=[],i=l.Zero,s=[],o=l.Zero;this[0].terms(e,function(e){r.push(e)},function(e){i=i["*"](e)}),this[1].terms(e,function(e){s.push(e)},function(e){o=o["*"](e)}),n(i["*"](o));var u=0;for(u=0;u<r.length;u++){var a;for(a=0;a<s.length;a++)t(r[u]["*"](s[a]))}return;case"/":var f=this;if(this[1]instanceof d.Constant){this[0].terms(e,function(e){t(e["/"](f[1]))},function(e){n(e["/"](f[1]))});return}throw"Expansion in denominator required"}},d.List.Real.prototype.factors=function(t,n,r,i){var s=~~(1e3*Math.random());console.log("("+s+") Attempt to find factors of: ",this);switch(this.operator){case"-":case"+":var o=[],u=l.One,a=[],f=l.One;this[0].factors(t,function(e){console.log(s+"< a: ",e),o.push(e)},function(e){console.log(s+"< a_c: ",e),u=u["*"](e)}),this[1].factors(t,function(e){console.log(s+"< b: ",e),a.push(e)},function(e){console.log(s+"< b_c: ",e),f=f["*"](e)});var c=[],h,p=o.length,d,v=a.length,m=l.One,g=l.One;for(h=0;h<p;h++){var y=!1;for(d=0;d<v;d++){if(a[d]===e)continue;if(o[h]===a[d]){c.push(o[h]),a[d]=e,y=!0;break}}y||(m=m["*"](o[h]))}for(d=0;d<v;d++){if(a[d]===e)continue;g=g["*"](a[d])}c.length?(console.log("common:",c,"of: ",o,a),c.forEach(n),console.log("(a,b) = ",m,g),console.log("(a_c,b_c) = ",u,f),n(m["*"](u)["+"](g["*"](f)))):r(this);return;case"*":this[0].factors(t,n,r),this[1].factors(t,n,r);return;case"/":this[0].factors(t,n,r);if(i===!1)return;this[1].factors(t,function(e,t){n(e,!t)},function(e,t){r(e,!t)});return}},function(){d.prototype.factors=function(e){return new Multiset},d.Symbol.Real.prototype.factors=function(e){var t=new Multiset([this],[1]);return t.vars=[],t},d.List.Real.prototype.factors=function(e){switch(this.operator){case"+":case"-":var t=this[0].factors(e),n=this[0].factors(e);return this.operator==="-"&&n.add(l.One["@-"]()),Multiset([this],[1]);case"*":var t=this[0].factors(e),n=this[1].factors(e);return t.union(n);case"/":var t=this[0].factors(e),n=this[1].factors(e).map(l.One["/"]);return t.union(n);case"@-":return Multiset(this[0].factors(e).add(l.One["@-"]()))}}},d.prototype.roots=function(e){return m([])},d.Symbol.prototype.roots=function(e){return e.indexOf(this)!==-1?m([new Statement(this,l.Zero,"=")]):m([])},d.prototype.dep=function(e){return!1},d.Symbol.Real.prototype.dep=function(e){return e.indexOf(this)!==-1},d.List.prototype.dep=function(e){return this[0].dep(e)?!0:this.operator&&this.operator[0]==="@"?!1:this[1].dep(e)?!0:!1},d.Function.Symbolic.prototype.inverse=function(){},d.List.Real.prototype.roots=function(e){if(this.operator==="*"){var t=this[0].roots(e),n=this[1].roots(e);return t.union(n)}if(this.operator==="+"){var r=l.One;this.factors(e,function(e,t){r=r["*"](e)},function(){},!1);if(r.operator==="*")return r.roots(e);if(!!this[1].dep(e)&&!!this[0].dep(e))throw"Cannot solve";var i=this[0].roots(e),s=this[0].roots(e)}else if(this.operator==="/"){var t=this[0].roots(e);return t}},t=n(C,d),t["+"]=function(e){if(e instanceof C)throw"Infinitesimal addition";return e},t["/"]=function(e){if(e instanceof C){if(e.x instanceof d.Symbol)return this.x.differentiate(e.x);throw"Confusing infitesimal division"}return this.x=this.x["/"](e),this},t["*"]=function(e){if(e instanceof C)return l.Zero;this.x=this.x["*"](e)},t.s=function(e){if(e!=="text/latex")throw"Infinitesimal numbers cannot be exported to programming languages";var t=this.x.s(e),n=x.precedence("default");return n>t.p&&(t.s="\\left("+t.s+"\\right)"),t.update("d"+t.s,n)},t=n(k,d.Function),t.default=function(e){return e.differentiate(this.x)},d.List.prototype.lim=function(e,t){switch(this.operator){case"+":case"-":return this[0].lim(e,t)[this.operator](this[1].lim(e,t));case"@-":case"@+":return this[0].lim(e,t)[this.operator]();case"/":var n=this[0].sub(e,t),r=this[1].sub(e,t);if(n===l.Zero&&r===l.Zero)return n=this[0].differentiate(e),r=this[1].differentiate(e),n["/"](r).lim(e,t);return n["/"](r);case"*":var i=this[0].sub(e,t),s=this[1].sub(e,t);if(i===l.Zero&&s==l.Infinity){var n=this[0].differentiate(e),r=l.One["/"](this[1]).differentiate(e);return n["/"](r).lim(e,t)}if(s===l.Zero&&i==l.Infinity){var n=this[0].differentiate(e),r=l.One["/"](this[1]).differentiate(e);return n["/"](r).lim(e,t)}return i["*"](s);case"^":if(this[0]===l.Zero)return l.Zero;if(this[1]===l.Zero&&this[0]!==l.Zero)return l.One;return this.sub(e,t);case"!":return this.sub(e,t)}},d.Vector=function(t){return t.__proto__=d.Vector.prototype,t},t=n(d.Vector,d),t[",."]=function(e){return d.Vector(Array.prototype.concat.call(this,[e]))},t.differentiate=function(e){return d.Vector(Array.prototype.map.call(this,function(t){return t.differentiate(e)}))},t.cross=function(e){if(this.length!==3||e.length!==3)throw"Cross product only defined for 3D vectors.";return new d.Vector([this[1].default(e[2])["-"](this[2].default(e[1])),this[2].default(e[0])["-"](this[0].default(e[2])),this[0].default(e[1])["-"](this[1].default(e[0]))])},t[s]=t.cross,t.default=function(e){var t=this.length;if(e instanceof d.Vector){if(t!==e.length)throw"Vector Dimension mismatch.";var n,r=l.Zero;for(n=0;n<t;n++)r=r["+"](this[n].default(e[n]));return r}if(!(e instanceof d.Matrix))return d.Vector(Array.prototype.map.call(this,function(t){return t.default(e)}))},t["*"]=t.default,t["+"]=function(e,t){var n=this.length;if(n!=e.length)throw new u("Vector Dimension mismatch.");var r,i=new Array(n);for(r=0;r<n;r++)i[r]=this[r][t||"+"](e[r]);return d.Vector(i)},t["-"]=function(e){return this["+"](e,"-")},t["/"]=function(e){if(e instanceof d.Vector)throw"Vector division not defined";return d.Vector(Array.prototype.map.call(this,function(t){return t["/"](e)}))},t["^"]=function(e){if(e instanceof d.Integer){if(e.a===0)throw"Raised to zero power";if(e.a===1)return this;if(e.a===2){var t=l.Zero,n,r=this.length;for(n=0;n<r;n++)t=t["+"](this[n]["^"](e));return t}return this["^"](new d.Integer(e.a-1))["*"](this)}if(e instanceof d.Rational)return this["^"](e.a)["^"](l.One["/"](e.b));if(e.constructor===d.NumericalComplex)return new d.Complex(this.value+e._real,e._imag);if(e.constructor===d.List.ComplexCartesian)return e["+"](this);if(e.constructor===d.List.ComplexPolar)return e["+"](this);if(e.constructor===d.List.Real)return e["+"](this);if(e.constructor===d.Symbol.Real)return e["+"](this);if(e.constructor===d.List)return e["+"](this);throw"Unknown Type for Vector ^"},t.apply=function(t,n){var r=this.length;switch(t){case",":return this[r]=n,this;case e:case"*":if(r!=n.length)throw"Vector Dimension mismatch.";var i,s=H.Global.Zero;for(i=0;i<r;i++)s=s.apply("+",this[i].apply("*",n[i]));return s;case"+":case"-":if(r!=n.length)throw"Vector Dimension mismatch.";var i,o=new Array(r);for(i=0;i<r;i++)o[i]=this[i].apply(t,n[i]);return d.Vector(o);case"/":case"^":default:throw"Vector operation not allowed."}},t.realimag=function(){var e=this.length,t=new Array(e),n=new Array(e),r;for(r=0;r<e;r++){var i=this[r].realimag();t[r]=i[0],n[r]=i[1]}return d.List.ComplexCartesian([d.Vector(t),d.Vector(n)])},d.Matrix=
function(e,t,n){return e.__proto__=d.Matrix.prototype,e.rows=t,e.cols=n,e},t=n(d.Matrix,d),t.default=t["*"]=function(e){if(e.constructor===d.Matrix){if(e.rows!==this.cols)throw"Matrix dimensions do not match.";var t=[],n,r,i,s=0;for(n=0;n<this.rows;n++)for(r=0;r<e.cols;r++){var o=l.Zero;for(i=0;i<e.rows;i++)o=o["+"](e[i*e.cols+r]);t[s++]=o}return d.Matrix(t)}throw"Unknown type"},t.reduce=function(e){var t,n;for(n=0;n<this.rows;n++)for(t=0;t<n;t++){var r=this[t*this.cols+t];if(r===l.Zero)throw"Row swap!";var i=this[n*this.cols+t]["/"](r),s;for(s=t+1;s<this.cols;s++)this[n*this.cols+s]=this[n*this.cols+s]["-"](i["*"](this[t*this.cols+s]))}return this},d.Sum=function(t,n,r,i){this.x=t,this.f=i,this.a=n,this.b=r},t=n(d.Sum,d.Symbol.Real),d.Sum.Real=function(t,n,r,i){this.x=t,this.f=i,this.a=n,this.b=r;if(!(this.x instanceof d.Symbol.Real))throw"Can only sum over reals in javascript"},t=d.Sum.Real.prototype=Object.create(d.Sum.prototype),t.constructor=d.Sum.Real,t.real=function(){return this},t.realimag=function(){return new d.List.ComplexCartesian([this,l.Zero])},t.s=function(e){if(e==="text/latex"){var t=this.f.s(e),n=this.a.s(e),r=this.b.s(e),i=this.x.s(e),s=t.s,o=t;return o=t.merge(n),o=t.merge(r),o.merge(i,"\\sum_{"+i.s+"="+n.s+"}^{"+r.s+"}"+s,x.precedence("*"))}if(e==="text/javascript"){var n=this.a.s(e),r=this.b.s(e);if(this.x instanceof d.Symbol.Real){var i=this.x.s(e),o=i.merge(n).merge(r),u=o.var(),a=o.var(),f=o.var(),l=o.var(),c=this.f.sub(this.x,new d.Symbol.Real(u)),t=c.s(e),h="var "+a+" = 0, "+u+", "+l+" = "+n.s+", "+f+" = "+r.s+";\nif("+f+" === Infinity) {\n	"+f+" = 1000;\n}\nif (!("+f+" >= "+l+')) {\n	throw("Halting problem solved.")\n}\nfor('+u+" = "+l+"; "+u+" < "+f+"; "+u+"++) {\n	"+a+" +="+t.s+";\n}\n";return o.merge(t,a,Infinity,h)}throw"Can only sum over reals in javascript"}if(e==="x-shader/x-fragment"){var n=this.a.s(e),r=this.b.s(e);if(this.x instanceof d.Symbol.Real){var i=this.x.s(e),o=i.merge(n).merge(r),u=o.var(),a=o.var(),c=this.f.sub(this.x,new d.Symbol.Real(u)),t=c.s(e),p="int("+n.s+")",v="int("+r.s+")",h="float "+a+" = 0.0;\nfor(float "+u+" = "+n.s+"; "+u+" < "+r.s+"; "+u+"+=1.0) {\n	"+a+" += "+" + "+t.s+";\n}\n";return o.merge(t,a,Infinity,h)}throw"Can only sum over reals in GLSL"}},t["^"]=function(e){if(this.b_locked)throw"Sum was upper bounded twice!";return this.b=e,this.b_locked=!0,this},t.default=function(e){if(!this.b_locked)throw"Sum was not upper bounded!";if(this.f_locked)throw"Sum already defined";return this.f=e,this.f_locked=!0,this},d.List.prototype.expand=function(e){var t=1,n=-1,r=l.Zero,i=l.Zero;throw"Should be async, don't use this"},d.prototype.simplify=function(){return this},d.prototype.integrate=function(e){throw"Could not integrate expression."},d.prototype.integrateN=function(e,t){if(t===0)return this;if(t<=-1)return this.differentiateN(e,t);if(t>1)return this.integrate(e).integrateN(e,t-1);if(t===1)return this.integrate(e)};var L={"void":1,vec3:2,bool:6,"int":3,fp:4,vec2:5,vec4:7,mat2:10,mat3:11,mat4:12,func:20},A={Boolean:1,Number:2,String:3,"undefined":4,Object:5,Function:L.func,Array:7,ref:8},O=x;t=M.prototype,M.newContext=function(){M.contextVariableCount=0},M.newContext(),t.var=function(){return"t"+(M.contextVariableCount++).toString(36)},t.merge=function(e,t,n,r){this.s=t,r&&this.pre.push(r);var i;return this.pre.push.apply(this.pre,e.pre),this.vars+=e.vars,this.p=n,this},t.update=function(e,t,n){return this.p=t,n&&this.pre.push(n),this.s=e,this},t.compile=function(e){return Function(e,this.pre.join("\n")+"return "+this.s)},t.glslFunction=function(e,t,n){return e+" "+t+"("+n+"){\n"+this.pre.join("\n")+"return "+this.s+";\n}\n"},d.List.prototype._s=function(e){if(e==="text/latex")return d.List.Real.prototype._s.call(this,e);throw"Use real(), imag(), or abs(), or arg() first."},d.List.Real.prototype._s=function(t){function n(e){return t==="text/latex"?"\\left("+e+"\\right)":"("+e+")"}function c(e){return f>e.p?n(e.s):e.s}if(this.operator===e){if(this[0]instanceof d.Function){if(this[0]===l.abs){var r=this[1]._s(t);if(t==="text/latex")return r.update("\\left|"+r.s+"\\right|",Infinity);var i=this[0]._s(t);return r.update(i.s+"("+r.s+")",Infinity)}var i=this[0]._s(t);if(this[1]instanceof d.Vector){var s=Array.prototype.map.call(this[1],function(e){return e._s(t)}),o,u=s.map(function(e){return e.s});this[0]===l.atan&&(u=u.reverse());var a=i.s;for(o=0;o<s.length;o++)i.merge(s[o]);return i.update(a+n(u),x.precedence("default"))}var r=this[1]._s(t);return i.merge(r,i.s+n(r.s),x.precedence("default"))}this.operator="*"}var f=x.precedence(this.operator);if(this.operator==="^"){if(t==="x-shader/x-fragment"){if(this[0]===l.e){var r=this[1]._s(t);return r.update("exp("+r.s+")")}if(this[1]instanceof d.Integer&&this[1].a<5&&this[1].a>-1){var i=this[0]._s(t),h=x.precedence("*"),p=e,v;this[0]instanceof d.Symbol?v=i.s:(v=i.var(),p="float "+v+" = "+i.s+";");var m=v,o;for(o=1;o<this[1].a;o++)m+="*"+v;return i.update("("+m+")",Infinity,p)}if(this[1]instanceof d.Integer&&this[1].a==-1){var i=this[0]._s(t);return i.update("(1.0/("+i.s+"))")}if(this[1]instanceof d.Rational){this[1]=this[1].reduce();var g=this[1].a%2?!1:!0;if(g){var r=this[1]._s(t),i=this[0]._s(t);return i.merge(r,"pow("+i.s+","+r.s+")")}var r=this[1]["-"](l.One)._s(t),i=this[0].s_(t);return i.merge(r,"(("+i.s+") * pow("+i.s+","+r.s+"))")}if(this[0]instanceof d.NumericalReal){var r=this[1]["-"](l.One)._s(t),i=this[0]._s(t);return i.merge(r,"(("+i.s+") * pow("+i.s+","+r.s+"))")}var r=this[1]["-"](l.One)._s(t),i=this[0]._s(t);return i.merge(r,"(("+i.s+") * pow("+i.s+","+r.s+"))")}if(t==="text/javascript"){if(this[0]===l.e){var r=this[1]._s(t);return r.update("Math.exp("+r.s+")")}if(this[1]instanceof d.Rational){var g=this[1].a%2?!1:!0;if(g){var r=this[1]._s(t),i=this[0]._s(t);return i.merge(r,"Math.pow("+i.s+","+r.s+")")}var r=this[1]._s(t),i=this[0]._s(t);return i.merge(r,"Math.pow("+i.s+","+r.s+")")}var r=this[1]._s(t),i=this[0]._s(t);return i.merge(r,"Math.pow("+i.s+","+r.s+")")}if(t==="text/latex"){var i=this[0]._s(t),r=this[1]._s(t);return i.merge(r,c(i)+"^"+"{"+r.s+"}")}}var i=this[0]._s(t);if(this.operator[0]==="@")return i.update(this.operator[1]+c(i),f);var r=this[1]._s(t);if(t==="text/latex"){if(this.operator==="/")return i.merge(r,"\\frac{"+i.s+"}{"+r.s+"}");if(this.operator==="*")return i.merge(r,c(i)+c(r),f)}else if(t==="x-shader/x-fragment"&&this.operator==="%")return i.merge(r,"mod("+c(i)+","+c(r)+")",f);return i.merge(r,c(i)+this.operator+c(r),f)},d.Statement.prototype._s=d.List.Real.prototype.s,d.Symbol.prototype._s=function(){return new M(this.symbol||"x_{free}")},d.NumericalReal.prototype._s=function(e){if(e==="x-shader/x-fragment"){var t=this.value.toExponential();return t.indexOf(".")===-1&&(t=t.replace("e",".e")),new M(t)}return new M(this.value.toString())},d.List.ComplexPolar.prototype._s=function(e){function r(e,t){return t>e.p?"\\left("+e.s+"\\right)":e.s}if(e!=="text/latex")throw"Exporting not supported for complex values.";var t=x.precedence("+"),n=x.precedence("*"),i=this[0]._s(e),s=this[1]._s(e);return i.merge(s,r(i,n)+""+"e^{i"+r(s,n))},d.List.ComplexCartesian.prototype._s=function(e){function n(e,t){return t>e.p?"\\left("+e.s+"\\right)":e.s}if(e!=="text/latex")throw"Exporting not supported for complex values.";var t=x.precedence("+"),r=this[0]._s(e),i=this[1]._s(e);return r.merge(i,n(r)+"+"+n(i,t)+"i",x.precedence("+"))},d.NumericalComplex.prototype._s=function(e){r("NumericalComplex.toTypedString????");if(e==="text/latex"){var t=this.realimag();if(this._real===0)return this._imag===1?new M("i"):this._imag===-1?new M("-i"):new M(t[1]._s(x).s+"i");return this._imag===0?new M(t[0]._s(x).s):this._imag===1?new M(t[0]._s(x).s+" + i"):this._imag===-1?new M(t[0]._s(x).s+" - i"):this._imag<0?new M(t[0]._s(x).s+" + "+t[1]._s(x).s+"i"):new M(t[0]+" + "+t[1]._s(x).s+"i")}throw"Please use x.realimag()[0 /* or 1 */].toTypedString() to generate code."},d.Integer.prototype._s=function(e){return e==="x-shader/x-fragment"?new M(this.a.toString()+".0"):new M(this.a.toString())},d.Vector.prototype._s=function(e){var t=this.length,n="[",r="]";e==="x-shader/x-fragment"&&(n="vec"+this.length+"(",r=")");var i=this[0]._s(e),s,o=[];for(s=0;s<t;s++){var u=this[s]._s(e);o.push(u.s),i=i.merge(u)}return i.update(n+o.join(",")+r,Infinity)},d.Statement.prototype._s=function(e){function n(e){return t>e.p?paren(e.s):e.s}var t=x.precedence(this.operator),r=this[0]._s(e),i=this[1]._s(e);return r.merge(i,n(r)+this.operator+n(i),t)},d.True._s=function(e){return new M("true")},d.False._s=function(e){return new M("false")},d.prototype.s=function(e){return M.newContext(),this._s(e)},d.prototype.compile=function(e){return this.s("text/javascript").compile(e)},d.prototype.glslFunction=function(e,t,n){return this.s("x-shader/x-fragment").glslFunction(e,t,n)},d.Numerical=d.Complex;var _=new d.Function({"default":function(e){if(e instanceof d.NumericalReal||e instanceof d.List.Real||e instanceof d.Symbol.Real)return new H.Expression.List.ComplexCartesian([l.sin.default(e),l.Zero]);throw new Error("Complex Sine Cartesian form not implemented yet.")}});l.sin=new d.Function({"default":function(e){return e instanceof d.NumericalReal?new d.NumericalReal(Math.sin(e.value)):e instanceof d.List.Real||e instanceof d.Symbol.Real?d.List.Real([l.sin,e]):d.List([l.sin,e])},realimag:function(){return _},"text/latex":"\\sin","text/javascript":"Math.sin","x-shader/x-fragment":"sin",title:"Sine Function",description:"See http://en.wikipedia.org/wiki/Trigonometric_functions#Sine.2C_cosine.2C_and_tangent",examples:["\\sin (\\pi)"],related:["cos","tan"]}),l.cos=new d.Function({"default":function(e){return e instanceof d.NumericalReal?new d.NumericalReal(Math.cos(e.value)):e instanceof d.List.Real||e instanceof d.Symbol.Real?d.List.Real([l.cos,e]):d.List([l.cos,e])},derivative:l.sin["@-"](),"text/latex":"\\cos","text/javascript":"Math.cos","x-shader/x-fragment":"cos",title:"Cosine Function",description:"Cosine Function desc",examples:["\\cos (\\pi)"],related:["sin","tan"]}),l.sin.derivative=l.cos,l.tan=new d.Function({symbolic:function(e){}}),l.log=new d.Function({"default":function(e,t){if(e instanceof d.Integer&&e.a===1)return l.Zero;if(e instanceof d.Integer&&e.a===0)return l.Infinity["@-"]();if(e instanceof d.NumericalReal){var n=e.value;if(n>0)return new d.NumericalReal(Math.log(n))}return t&&t.positive?d.List.Real([l.log,e]):d.List([l.log,e])},realimag:function(e){return P},"text/latex":"\\log","text/javascript":"Math.log","x-shader/x-fragment":"log",title:"Natural Logarithm",description:"Base e. See http://en.wikipedia.org/wiki/Natural_logarithm",examples:["\\log (ye^(2x))"],related:["exp","Log"]});var D=new d.Rational(1,2),P=new d.Function({"default":function(e){return(new d.List.ComplexCartesian([l.log.default(e.abs()),e.arg()]))["*"](D)}});P.__proto__=l.log,l.atan2=new d.Function({"default":function(e){if(e instanceof d.Vector)return e[0]instanceof d.NumericalReal&&e[1]instanceof d.NumericalReal?new d.NumericalReal(Math.atan2(e[0].value,e[1].value)):new d.List.Real([l.atan2,e]);throw"atan only takes vector arguments"},apply_realimag:function(e,t){return[d.List([l.atan2,t]),H.Global.Zero]},"text/latex":"\\tan^{-1}","text/javascript":"Math.atan2","x-shader/x-fragment":"atan",toTypedString:function(e){return{s:this[e],t:A.Function}},title:"Two argument arctangent function",description:"Arctan(y, x). Will equal arctan(y / x) except when x and y are both negative. See http://en.wikipedia.org/wiki/Atan2"}),l.atan=l.atan2,l.Gamma={"default":function(e){function t(e){var t,n,r,i,s,o=[57.15623566586292,-59.59796035547549,14.136097974741746,-0.4919138160976202,3399464998481189e-20,4652362892704858e-20,-0.00009837447530487956,.0001580887032249125,-0.00021026444172410488,.00021743961811521265,-0.0001643181065367639,8441822398385275e-20,-0.000026190838401581408,36899182659531625e-22];if(e<=0)throw"bad arg in gammln";i=n=e,r=n+5.2421875,r=(n+.5)*Math.log(r)-r,s=.9999999999999971;for(t=0;t<14;t++)s+=o[t]/++i;return r+Math.log(2.5066282746310007*s/n)}if(e instanceof d.Integer){var n=e.a;if(n<0)return l.ComplexInfinity;if(n<15){var r=1,i=0;for(i=1;i<n;i++)r*=i;return new d.Integer(r)}return d.List.Real([l.Gamma,e])}if(e instanceof d.NumericalReal){var n=e.value;return n===0?l.Infinity:n<0?new d.NumericalReal(-Math.PI/(n*Math.sin(Math.PI*n)*Math.exp(t(-n)))):new d.NumericalReal(Math.exp(t(n)))}return e instanceof d.NumericalComplex,d.List([l.Gamma,e])},"text/latex":"\\Gamma","text/javascript":"M.Global.Gamma.f",toTypedString:function(e){return{s:this[e],t:A.Function}},title:"Gamma Function",description:"See http://en.wikipedia.org/wiki/Gamma_function",examples:["\\Gamma (x)","x!"],related:["Log","LogGamma"]},l.Re={"default":function(e){return e.real()},apply_realimag:function(e,t){return[t.real(),l.Zero]},"text/latex":"\\Re"},l.Im={"default":function(e){return e.imag()},distributed_under_differentiation:!0,apply_realimag:function(e,t){return[t.imag(),l.Zero]},"text/latex":"\\Im"},d.List.Real.prototype.positive=function(){if(this.operator==="+")return this[0].positive&&this[1].positive&&this[0].positive()&&this[1].positive();if(this.operator==="*")return this[0]===this[1]?!0:this[0].positive&&this[1].positive&&this[0].positive()&&this[1].positive();if(this.operator==="^"&&this[1]instanceof d.Rational){var e=this[1].reduce();if(e.a%2===0)return!0}return!1},d.NumericalReal.prototype.positive=function(){return this.value>0},l.sqrt=new d.Function({"default":function(t){if(t instanceof d.NumericalReal){var n=t.value;return n<0?new d.List.ComplexCartesian([l.Zero,new d.NumericalReal(Math.sqrt(n))]):new d.NumericalReal(Math.sqrt(n))}return t instanceof d.List.Real?t.positive()?d.List.Real([l.sqrt,t]):d.List([l.sqrt,t]):t instanceof d.List.ComplexPolar?new d.List.ComplexPolar([t[0],t[1]["/"](new d.Integer(2))]):t instanceof d.List.ComplexCartesian?new d.List([l.sqrt,t]):d.List([l.sqrt,t])},apply_realimag:function(e,t){return t["^"](new d.Rational(1,2)).realimag()},"text/latex":"\\sqrt","text/javascript":"Math.sqrt","x-shader/x-fragment":"sqrt",toTypedString:function(e){return{s:this[e],t:A.Function}},title:"Sqrt Function",description:"See http://en.wikipedia.org/wiki/Square_Root",examples:["\\sqrt (x^4)"],related:["pow","abs","mod"]}),l.abs=new d.Function({"default":function(e){return e.abs()},"text/latex":"\\abs","text/javascript":"Math.abs","x-shader/x-fragment":"abs",titie:"Absolute Value Function",description:"Abs",examples:["\\abs (-3)","\\abs (i+3)"],related:["arg","tan"]}),l.abs.derivative=function(){var e=new d.Symbol.Real,t=e["/"](e.abs());return new d.Function.Symbolic(t,[e])}(),l.arg={"default":function(e){return console.warn("ARG IS FOR USER INPUT ONLY. USE .arg()"),e.arg()},"text/latex":"\\arg","text/javascript":"Math.arg_real",toTypedString:function(e){return{s:this[e],t:A.Function}},titie:"Arg Function",description:"Arg",examples:["\\arg (-3)","\\arg (3)","\\arg(3+2i)"],related:["abs"]},l.e=new d.NumericalReal(Math.E,0),l.e.title="e",l.e.description="The transcendental number that is the base of the natural logarithm, approximately equal to 2.71828.",l.e.s=function(e){return e==="text/javascript"?new M("Math.E"):e=="text/latex"?new M("e"):new M("2.718281828459045")},l.pi=new d.NumericalReal(Math.PI,0),l.pi.title="Pi",l.pi.description="",l.pi.s=function(e){return e==="text/javascript"?new M("Math.PI"):e==="text/latex"?new M("\\pi"):new M("3.141592653589793")},l.tau=l.pi["*"](new d.Integer(2)),l.Infinity=new d.NumericalReal(Infinity,0),l.Infinity.title="Infinity",l.Infinity.description="",l.infty=l.Infinity,l.Zero=new d.Integer(0),l.Zero.title="Zero",l.Zero.description="Additive Identity",l.Zero["*"]=function(e){return l.Zero},l.Zero["+"]=function(e){return e},l.Zero["@-"]=function(e){return this},l.Zero["-"]=function(e){return e["@-"]()},l.One=new d.Integer(1),l.One.title="One",l.One.description="Multiplicative Identity",l.One["*"]=function(e){return e},l.log.derivative=new d.Function.Symbolic(l.One["/"](new d.Symbol.Real)),l.i=new d.List.ComplexCartesian([l.Zero,l.One]),l.i.title="Imaginary Unit",l.i.description="A number which satisfies the property <m>i^2 = -1</m>.",l.i.realimag=function(){return d.List.ComplexCartesian([l.Zero,l.One])},l.i["*[TODO]"]=function(e){},l.d=new d.Function({"default":function(e){return new C(e)}}),l.d["/"]=function(e){if(e instanceof C){if(e.x instanceof d.Symbol)return new k(e.x);if(e.x instanceof d.Vector)return d.Vector(Array.prototype.map.call(e.x,function(e){return new k(e)}));throw"Confusing infitesimal division"}throw"Dividing d by some large number."},l["undefined"]={s:function(e){if(e==="text/javascript")return new M("undefined");if(e==="x-shader/x-fragment")return new M("(1.0/0.0)")},differentiate:function(){return this},"*":function(){return this},"+":function(){return this},"-":function(){return this},"/":function(){return this},"^":function(){return this},"@-":function(){return this}},l.sum=new d.Function({"default":function(e){throw"Sum not properly constructed yet."}}),l.sum._=function(e){var t=e[0],n=e[1];return new d.Sum.Real(t,n)},H.toString=function(){return"function M(expression, context) {\n    /*!\n     *  Math JavaScript Library v3.9.1\n     *  https://github.com/aantthony/javascript-cas\n     *  \n     *  Copyright 2010 Anthony Foster. All rights reserved.\n     */\n    [awesome code]\n}"},H.Context=h,H.Expression=d,H.Global=l,H.Error=u;var B={};H.register=function(e,t){if(d.prototype[e])throw"Method ."+e+" is already in use!";B[e]=t},H.load=function(e,t){B[e](H,d,t),delete B[e]},typeof module!="undefined"?module.exports=H:window.M=H,console.log("Load time:",new Date-i,"ms")})();