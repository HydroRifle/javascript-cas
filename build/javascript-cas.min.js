/**
*  javascript-cas v3.0.1
*  https://github.com/aantthony/javascript-cas
*  
*  Copyright 2010 Anthony Foster.
*  2013-03-22
*/
(function(t){"use strict";function e(t,e){var i=t.prototype=Object.create(e.prototype);return i.constructor=t,i}function i(e){var i=Error(e).stack;return i?(console.warn(i.replace(/^Error\: /,"Deprecated: ")),t):console.warn("Deprecated: "+e)}function r(t){this.message=t}function n(e){function i(t,e,i){var n=[e,s++,i];if("object"==typeof t)for(var a=0;t.length>a;a++)r[t[a]]=n;else r[t]=n}var r={},s=0;e.forEach(function(e){i(e[0],e[1]||L,e[2]===t?2:e[2])}),this.operators=r,n.build.call(this)}function s(){}function o(t,e){var i=N.parse(t,e);return i}function l(t,e){this.A=t||[],this.m=e||[]}function u(t){return t.__proto__=u.prototype,t}function c(){}function h(t,e){return new o.Conditional(t.cond,e(t.a),e(t.b))}function f(t){this.x=t}function p(t){this.x=t}function m(t,e){this.pre=[]||e,this.s=""||t,this.vars=0,this.p=1/0}function y(t,e){var i=o(t,e||y.Global);return i}var g,d=function(){function e(){this.yy={}}var i={trace:function(){},yy:{},symbols_:{error:2,expressions:3,S:4,EOF:5,e:6,stmt:7,"=":8,"!=":9,"<=":10,"<":11,">":12,">=":13,csl:14,",":15,vector:16,"(":17,")":18,"+":19,"-":20,"*":21,"/":22,"POWER{":23,"}":24,"_{":25,_SINGLE:26,"SQRT{":27,"FRAC{":28,"{":29,"^SINGLE":30,identifier:31,number:32,IDENTIFIER:33,LONGIDENTIFIER:34,DECIMAL:35,INTEGER:36,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"=",9:"!=",10:"<=",11:"<",12:">",13:">=",15:",",17:"(",18:")",19:"+",20:"-",21:"*",22:"/",23:"POWER{",24:"}",25:"_{",26:"_SINGLE",27:"SQRT{",28:"FRAC{",29:"{",30:"^SINGLE",33:"IDENTIFIER",34:"LONGIDENTIFIER",35:"DECIMAL",36:"INTEGER"},productions_:[0,[3,2],[4,1],[4,1],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[14,3],[14,3],[16,3],[6,3],[6,3],[6,3],[6,3],[6,4],[6,4],[6,2],[6,3],[6,6],[6,2],[6,2],[6,2],[6,3],[6,1],[6,1],[6,1],[31,1],[31,1],[32,1],[32,1]],performAction:function(t,e,i,r,n,s){var a=s.length-1;switch(n){case 1:return s[a-1];case 2:this.$=s[a];break;case 3:this.$=s[a];break;case 4:this.$=["=",s[a-2],s[a]];break;case 5:this.$=["!=",s[a-2],s[a]];break;case 6:this.$=["<=",s[a-2],s[a]];break;case 7:this.$=["<",s[a-2],s[a]];break;case 8:this.$=[">",s[a-2],s[a]];break;case 9:this.$=[">=",s[a-2],s[a]];break;case 10:this.$=[",.",s[a-2],s[a]];break;case 11:this.$=[",",s[a-2],s[a]];break;case 12:this.$=s[a-1];break;case 13:this.$=["+",s[a-2],s[a]];break;case 14:this.$=["-",s[a-2],s[a]];break;case 15:this.$=["*",s[a-2],s[a]];break;case 16:this.$=["/",s[a-2],s[a]];break;case 17:this.$=["^",s[a-3],s[a-1]];break;case 18:this.$=["_",s[a-3],s[a-1]];break;case 19:this.$=["_",s[a-1],v.Single(t.substring(1))];break;case 20:this.$=["sqrt",s[a-1]];break;case 21:this.$=["frac",s[a-4],s[a-1]];break;case 22:this.$=["^",s[a-1],v.Single(t.substring(1))];break;case 23:this.$=["@-",s[a]];break;case 24:this.$=["default",s[a-1],s[a]];break;case 25:this.$=s[a-1];break;case 26:this.$=s[a];break;case 27:this.$=s[a];break;case 28:this.$=s[a];break;case 29:this.$=t;break;case 30:this.$=t.substring(1);break;case 31:this.$=v.Number(t);break;case 32:this.$=v.Number(t)}},table:[{3:1,4:2,6:3,7:4,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{1:[3]},{5:[1,16]},{5:[2,2],6:25,8:[1,26],9:[1,27],10:[1,28],11:[1,29],12:[1,30],13:[1,31],16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,2],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,3],24:[2,3]},{6:32,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:33,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:34,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:35,14:36,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,26],8:[2,26],9:[2,26],10:[2,26],11:[2,26],12:[2,26],13:[2,26],15:[2,26],17:[2,26],18:[2,26],19:[2,26],20:[2,26],21:[2,26],22:[2,26],23:[2,26],24:[2,26],25:[2,26],26:[2,26],27:[2,26],28:[2,26],30:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26]},{5:[2,27],8:[2,27],9:[2,27],10:[2,27],11:[2,27],12:[2,27],13:[2,27],15:[2,27],17:[2,27],18:[2,27],19:[2,27],20:[2,27],21:[2,27],22:[2,27],23:[2,27],24:[2,27],25:[2,27],26:[2,27],27:[2,27],28:[2,27],30:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27]},{5:[2,28],8:[2,28],9:[2,28],10:[2,28],11:[2,28],12:[2,28],13:[2,28],15:[2,28],17:[2,28],18:[2,28],19:[2,28],20:[2,28],21:[2,28],22:[2,28],23:[2,28],24:[2,28],25:[2,28],26:[2,28],27:[2,28],28:[2,28],30:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28]},{5:[2,29],8:[2,29],9:[2,29],10:[2,29],11:[2,29],12:[2,29],13:[2,29],15:[2,29],17:[2,29],18:[2,29],19:[2,29],20:[2,29],21:[2,29],22:[2,29],23:[2,29],24:[2,29],25:[2,29],26:[2,29],27:[2,29],28:[2,29],30:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29]},{5:[2,30],8:[2,30],9:[2,30],10:[2,30],11:[2,30],12:[2,30],13:[2,30],15:[2,30],17:[2,30],18:[2,30],19:[2,30],20:[2,30],21:[2,30],22:[2,30],23:[2,30],24:[2,30],25:[2,30],26:[2,30],27:[2,30],28:[2,30],30:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30]},{5:[2,31],8:[2,31],9:[2,31],10:[2,31],11:[2,31],12:[2,31],13:[2,31],15:[2,31],17:[2,31],18:[2,31],19:[2,31],20:[2,31],21:[2,31],22:[2,31],23:[2,31],24:[2,31],25:[2,31],26:[2,31],27:[2,31],28:[2,31],30:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31]},{5:[2,32],8:[2,32],9:[2,32],10:[2,32],11:[2,32],12:[2,32],13:[2,32],15:[2,32],17:[2,32],18:[2,32],19:[2,32],20:[2,32],21:[2,32],22:[2,32],23:[2,32],24:[2,32],25:[2,32],26:[2,32],27:[2,32],28:[2,32],30:[2,32],33:[2,32],34:[2,32],35:[2,32],36:[2,32]},{1:[2,1]},{6:37,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:38,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:39,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:40,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:41,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{4:42,6:3,7:4,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,19],8:[2,19],9:[2,19],10:[2,19],11:[2,19],12:[2,19],13:[2,19],15:[2,19],17:[2,19],18:[2,19],19:[2,19],20:[2,19],21:[2,19],22:[2,19],23:[2,19],24:[2,19],25:[2,19],26:[2,19],27:[2,19],28:[2,19],30:[2,19],33:[2,19],34:[2,19],35:[2,19],36:[2,19]},{5:[2,22],8:[2,22],9:[2,22],10:[2,22],11:[2,22],12:[2,22],13:[2,22],15:[2,22],17:[2,22],18:[2,22],19:[2,22],20:[2,22],21:[2,22],22:[2,22],23:[2,22],24:[2,22],25:[2,22],26:[2,22],27:[2,22],28:[2,22],30:[2,22],33:[2,22],34:[2,22],35:[2,22],36:[2,22]},{5:[2,24],6:25,8:[2,24],9:[2,24],10:[2,24],11:[2,24],12:[2,24],13:[2,24],15:[2,24],16:9,17:[1,8],18:[2,24],19:[2,24],20:[2,24],21:[2,24],22:[2,24],23:[1,21],24:[2,24],25:[2,24],26:[2,24],27:[2,24],28:[2,24],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:43,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:44,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:45,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:46,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:47,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:48,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,49],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,50],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,23],6:25,8:[2,23],9:[2,23],10:[2,23],11:[2,23],12:[2,23],13:[2,23],15:[2,23],16:9,17:[1,8],18:[2,23],19:[2,23],20:[2,23],21:[2,23],22:[2,23],23:[1,21],24:[2,23],25:[2,23],26:[2,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[1,52],16:9,17:[1,8],18:[1,51],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{15:[1,54],18:[1,53]},{5:[2,13],6:25,8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],15:[2,13],16:9,17:[1,8],18:[2,13],19:[2,13],20:[2,13],21:[1,19],22:[1,20],23:[1,21],24:[2,13],25:[2,13],26:[2,13],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,14],6:25,8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],15:[2,14],16:9,17:[1,8],18:[2,14],19:[2,14],20:[2,14],21:[2,23],22:[2,23],23:[1,21],24:[2,14],25:[2,14],26:[2,14],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,15],6:25,8:[2,15],9:[2,15],10:[2,15],11:[2,15],12:[2,15],13:[2,15],15:[2,15],16:9,17:[1,8],18:[2,15],19:[2,15],20:[2,15],21:[2,15],22:[2,15],23:[1,21],24:[2,15],25:[2,15],26:[2,15],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,16],6:25,8:[2,16],9:[2,16],10:[2,16],11:[2,16],12:[2,16],13:[2,16],15:[2,16],16:9,17:[1,8],18:[2,16],19:[2,16],20:[2,16],21:[2,16],22:[2,16],23:[1,21],24:[2,16],25:[2,16],26:[2,16],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,55],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{24:[1,56]},{5:[2,4],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,4],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,5],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,5],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,6],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,6],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,7],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,7],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,8],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,8],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,9],6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[2,9],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,20],8:[2,20],9:[2,20],10:[2,20],11:[2,20],12:[2,20],13:[2,20],15:[2,20],17:[2,20],18:[2,20],19:[2,20],20:[2,20],21:[2,20],22:[2,20],23:[2,20],24:[2,20],25:[2,20],26:[2,20],27:[2,20],28:[2,20],30:[2,20],33:[2,20],34:[2,20],35:[2,20],36:[2,20]},{29:[1,57]},{5:[2,25],8:[2,25],9:[2,25],10:[2,25],11:[2,25],12:[2,25],13:[2,25],15:[2,25],17:[2,25],18:[2,25],19:[2,25],20:[2,25],21:[2,25],22:[2,25],23:[2,25],24:[2,25],25:[2,25],26:[2,25],27:[2,25],28:[2,25],30:[2,25],33:[2,25],34:[2,25],35:[2,25],36:[2,25]},{6:58,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],15:[2,12],17:[2,12],18:[2,12],19:[2,12],20:[2,12],21:[2,12],22:[2,12],23:[2,12],24:[2,12],25:[2,12],26:[2,12],27:[2,12],28:[2,12],30:[2,12],33:[2,12],34:[2,12],35:[2,12],36:[2,12]},{6:59,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,17],8:[2,17],9:[2,17],10:[2,17],11:[2,17],12:[2,17],13:[2,17],15:[2,17],17:[2,17],18:[2,17],19:[2,17],20:[2,17],21:[2,17],22:[2,17],23:[2,17],24:[2,17],25:[2,17],26:[2,17],27:[2,17],28:[2,17],30:[2,17],33:[2,17],34:[2,17],35:[2,17],36:[2,17]},{5:[2,18],8:[2,18],9:[2,18],10:[2,18],11:[2,18],12:[2,18],13:[2,18],15:[2,18],17:[2,18],18:[2,18],19:[2,18],20:[2,18],21:[2,18],22:[2,18],23:[2,18],24:[2,18],25:[2,18],26:[2,18],27:[2,18],28:[2,18],30:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18]},{6:60,16:9,17:[1,8],20:[1,7],27:[1,5],28:[1,6],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[2,11],16:9,17:[1,8],18:[2,11],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,15:[2,10],16:9,17:[1,8],18:[2,10],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{6:25,16:9,17:[1,8],19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:[1,21],24:[1,61],25:[1,22],26:[1,23],27:[1,5],28:[1,6],30:[1,24],31:10,32:11,33:[1,12],34:[1,13],35:[1,14],36:[1,15]},{5:[2,21],8:[2,21],9:[2,21],10:[2,21],11:[2,21],12:[2,21],13:[2,21],15:[2,21],17:[2,21],18:[2,21],19:[2,21],20:[2,21],21:[2,21],22:[2,21],23:[2,21],24:[2,21],25:[2,21],26:[2,21],27:[2,21],28:[2,21],30:[2,21],33:[2,21],34:[2,21],35:[2,21],36:[2,21]}],defaultActions:{16:[2,1]},parseError:function(t){throw Error(t)},parse:function(e){function i(){var t;return t=r.lexer.lex()||1,"number"!=typeof t&&(t=r.symbols_[t]||t),t}var r=this,n=[0],s=[null],a=[],o=this.table,l="",u=0,c=0,h=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,this.lexer.yylloc===t&&(this.lexer.yylloc={});var f=this.lexer.yylloc;a.push(f);var p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var m,y,g,d,w,x,v,_,R,b={};;){if(g=n[n.length-1],this.defaultActions[g]?d=this.defaultActions[g]:((null===m||m===t)&&(m=i()),d=o[g]&&o[g][m]),d===t||!d.length||!d[0]){var L="";if(!h){R=[];for(x in o[g])this.terminals_[x]&&x>2&&R.push("'"+this.terminals_[x]+"'");L=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+R.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:R})}}if(d[0]instanceof Array&&d.length>1)throw Error("Parse Error: multiple actions possible at state: "+g+", token: "+m);switch(d[0]){case 1:n.push(m),s.push(this.lexer.yytext),a.push(this.lexer.yylloc),n.push(d[1]),m=null,y?(m=y,y=null):(c=this.lexer.yyleng,l=this.lexer.yytext,u=this.lexer.yylineno,f=this.lexer.yylloc,h>0&&h--);break;case 2:if(v=this.productions_[d[1]][1],b.$=s[s.length-v],b._$={first_line:a[a.length-(v||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(v||1)].first_column,last_column:a[a.length-1].last_column},p&&(b._$.range=[a[a.length-(v||1)].range[0],a[a.length-1].range[1]]),w=this.performAction.call(b,l,c,u,this.yy,d[1],s,a),w!==t)return w;v&&(n=n.slice(0,2*-1*v),s=s.slice(0,-1*v),a=a.slice(0,-1*v)),n.push(this.productions_[d[1]][0]),s.push(b.$),a.push(b._$),_=o[n[n.length-2]][n[n.length-1]],n.push(_);break;case 3:return!0}}return!0}},r=function(){var e={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===r.length?this.yylloc.first_column:0)+r[r.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return 20>t.length&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,i,r,n,s;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),o=0;a.length>o&&(r=this._input.match(this.rules[a[o]]),!r||i&&!(r[0].length>i[0].length)||(i=r,n=o,this.options.flex));o++);return i?(s=i[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+i[0].length},this.yytext+=i[0],this.match+=i[0],this.matches=i,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(i[0].length),this.matched+=i[0],e=this.performAction.call(this,this.yy,this,a[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:t):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e!==t?e:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)},options:{},performAction:function(t,e,i,r){switch(i){case 0:break;case 1:return"TEXT";case 2:return 17;case 3:return 18;case 4:return 28;case 5:return 27;case 6:return 21;case 7:return 10;case 8:return 13;case 9:return"NE";case 10:return 34;case 11:return 33;case 12:return 35;case 13:return 36;case 14:return 8;case 15:return 21;case 16:return 21;case 17:return 22;case 18:return 20;case 19:return 19;case 20:return 10;case 21:return 13;case 22:return 11;case 23:return 12;case 24:return 9;case 25:return"&&";case 26:return 26;case 27:return 30;case 28:return 25;case 29:return 23;case 30:return"!";case 31:return"%";case 32:return 15;case 33:return"?";case 34:return":";case 35:return 17;case 36:return 18;case 37:return 29;case 38:return 24;case 39:return"[";case 40:return"]";case 41:return 5}},rules:[/^(?:\s+)/,/^(?:\$[^\$]*\$)/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\\frac\{)/,/^(?:\\sqrt\{)/,/^(?:\\cdot\b)/,/^(?:\\l[e])/,/^(?:\\g[e])/,/^(?:\\n[e])/,/^(?:\\[a-zA-Z]+)/,/^(?:[a-zA-Z])/,/^(?:[0-9]+\.[0-9]*)/,/^(?:[0-9]+)/,/^(?:=)/,/^(?:\*)/,/^(?:\.)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:<=)/,/^(?:>=)/,/^(?:<)/,/^(?:>)/,/^(?:!=)/,/^(?:&&)/,/^(?:_[^\(\{])/,/^(?:\^[^\(\{])/,/^(?:_\{)/,/^(?:\^\{)/,/^(?:!)/,/^(?:%)/,/^(?:,)/,/^(?:\?)/,/^(?::)/,/^(?:\()/,/^(?:\))/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:!0}}};return e}();return i.lexer=r,e.prototype=i,i.Parser=e,new e}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=d,exports.Parser=d.Parser,exports.parse=function(){return d.parse.apply(d,arguments)},exports.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),process.exit(1));var e=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(e)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)));var w=new Date;g=e(r,Error);var x=String.fromCharCode(215);g=n.prototype,g.precedence=function(t){if(!this.operators[t])throw"Precedence of "+t+" not known!";return this.operators[t][1]},g.postfix=function(t){var e=this.operators[t];return 0===e[0]&&1===e[2]},g.unary=function(t){var e=["+","-","±"];return-1!=e.indexOf(t)?"@"+t:!1},g.assoc=function(t){return this.operators[t][1]===!0},g.Number=function(t){var e={0:_.Zero,1:_.One};if(e[t])return e[t];if(/^[\d]+$/.test(t))return new o.Integer(Number(t));if(/^[\d]*\.[\d]+$/.test(t)){var i=t.indexOf("."),r=t.length-i-1,n=Math.pow(10,r),s=Number(t.replace(".",""));return new o.Rational(s,n).reduce()}return e[t]||new o.NumericalReal(Number(t))};var v={};v.Number=function(t){var e={0:_.Zero,1:_.One};if(e[t])return e[t];if(/^[\d]+$/.test(t))return new o.Integer(Number(t));if(/^[\d]*\.[\d]+$/.test(t)){var i=t.indexOf("."),r=t.length-i-1,n=Math.pow(10,r),s=Number(t.replace(".",""));return new o.Rational(s,n).reduce()}return e[t]||new o.NumericalReal(Number(t))},v.String=function(t){return t},v.Single=function(t){var e=Math.round(t);return e==t?new o.Integer(e):t};var _={};g=s.prototype=Object.create(_),g.reset=function(){this.splice(0)},g.impliesExpression=function(){return!1},g.learn=function(t){this.equations.push(t)},n.build=function(){this.parse=function(e,i){function r(t){l=Object.create(l);var e;for(e in t)t.hasOwnProperty(e)&&(l[e]=t[e])}function n(t){return l=l.__proto__,t}function s(t){if("string"==typeof t){var e;return(e=l[t])?e:((e=i[t])?c[t]=e:u[t]=e=new o.Symbol.Real(t),a[t]=e)}if("object"==typeof t){var h=s(t[1]);if(3===t.length){switch(t[0]){case"frac":t[0]="/";break;case"_":if("sum"===t[1]){var f=t[2];if("="===f[0]){var p=new o.Symbol.Real(f[1]),m=s(f[2]),y=new o.Sum.Real(p,m);return y.vars={},y.vars[p.symbol]=p,y}}}if("default"===t[0]&&h.vars){r(h.vars);var g=h[t[0]](s(t[2]));return delete g.vars,n(g)}return h[t[0]](s(t[2]))}if(2===t.length){switch(t[0]){case"sqrt":return _.sqrt.default(s(t[1]))}return s(t[1])[t[0]]()}if(4===t.length)return s(t[1])[t[0]](s(t[1]),s(t[2]))}return t}if(""===e)return t;var a=Object.create({}),l=a,u={},c={},h=calculator.parse(e),f=s(h);if(f._ast=h,a!==l)throw"Context still open";return f.unbound=u,f.bound=c,f}},calculator.parseError=function(t,e){var i=new SyntaxError(t);throw i.line=e.line,i},calculator.lexer.next__=function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,i,r,n,s;this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),o=0;a.length>o;o++)if(r=this._input.match(this.rules[a[o]])){i=r,n=o;break}return i?(s=i[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+i[0].length},this.yytext+=i[0],this.match+=i[0],this.matches=i,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(i[0].length),this.matched+=i[0],e=this.performAction.call(this,this.yy,this,a[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:t):""===this._input?this.EOF:(console.log("input",this._input),this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno}))},g=o.prototype,g.toString=null,g.valueOf=null,g.identity=function(){return i("Slow"),this},g.imageURL=function(){return"http://latex.codecogs.com/gif.latex?"+encodeURIComponent(this.s("text/latex").s)},g.renderLaTeX=function(){var t=new Image;return t.src=this.imageURL(),t},g.sub=function(){return this},g.lim=function(t,e){return this.sub(t,e)},g[","]=function(t){return t instanceof o.Statement?new o.Conditional(t,this):o.Vector([this,t])},g["="]=function(t){return new o.Statement(this,t,"=")},g["!="]=function(t){return new o.Statement(this,t,"!=")},g[">"]=function(t){return new o.Statement(this,t,">")},g[">="]=function(t){return new o.Statement(this,t,">=")},g["<"]=function(t){return new o.Statement(this,t,"<")},g["<="]=function(t){return new o.Statement(this,t,"<=")},g[x]=function(t){return this["*"](t)},g.default=function(t){return this["*"](t)},g["/"]=function(t){return new o.List([this,t],"/")},g["+"]=function(t){return new o.List([this,t],"+")},g["-"]=function(t){return new o.List([this,t],"-")},g["@-"]=function(){return new o.List([this],"@-")},g["^"]=function(t){return new o.List([this,t],"^")},g["%"]=function(t){return new o.List([this,t],"%")},g["*"]=function(t){return t===_.Zero?t:t===_.One?this:new o.List([this,t],"*")},o.List=function(t,e){return t.__proto__=o.List.prototype,t.operator=e,t},g=e(o.List,o),g.sub=function(t,e){var i=this[0].sub(t,e);if(1===this.length)return i[this.operator]();var r=this[1].sub(t,e);return i[this.operator||"default"](r)},g["@-"]=function(){return"@-"===this.operator?this[0]:new o.List([this],"@-")},g=l.prototype,g.add=function(t){var e=this.A.indexOf(t);if(-1===e){var i=this.length;this.A[i]=t,this.m[i]=1}else this.m[e]++;return this},g.remove=function(t){var e=this.A.indexOf(t);return this.m[e]--,this},g.intersect=function(){throw"What is multiset intersection?"},g.map=function(t){return l(Array.prototype.map.call(this.A,t),this.m)},l.fromArray=function(){throw"NYI"},g=u.prototype,g.intersect=function(t){var e,i,r=this.length,n=t.length,s=new u([]);for(e=0;r>e;e++)for(i=0;n>i;i++){var a=this[e],o=t[i];if(a===o){s[s.length]=a;break}var l=a["-"](o);if(l===_.Zero){s[s.length]=a;break}}return a},g.union=function(t){return u(Array.prototype.concat.call(this,t))},g.remove=function(t){var e=this.indexOf(t);return this[e]=this[this.length-1],this.length--,this},g.add=function(t){return-1===this.indexOf(t)&&(this[this.length]=t),this},g.map=function(t){return u(Array.prototype.map.call(this,t))},g.compose=function(){},g.cardinality=function(){return this.length},c.aleph_0={">":function(e){return e instanceof o.NumericalReal?o.True:t}},g=c.prototype=Object.create(u.prototype),g.cardinality=function(){return c.cardinality};var R,b,L=R=0,C=b=1,N=new n([[";"],[","],[["=","+=","-=","*=","/=","%=","&=","^=","|="],C],[["?",":"],C,2],[["∨"]],[["&&"]],[["|"]],[["??????"]],[["&"]],[["==","≠","!==","==="]],[["<","<=",">",">="],L],[[">>","<<"]],["±",C,2],[["+"],!0],[["-"],L],[["∫","∑"],C,1],[["*","%"],C],[x,C],[["@+","@-","@±"],C,1],[["¬"],L,1],["default",C,2],["∘",C,2],[["/"]],[["^"]],["!",L,1],[["~"],C,1],[["++","++",".","->"],L,1],[["::"]],[["_"],L,2],["var",C,1],["break",C,0],["throw",C,1],["'",L,1],["√",C,1],["#",C,1]]);new n([[";"],[","],[["=","+="]]]),o.TruthValue=function(){},g=e(o.TruthValue,o),o.True=new o.TruthValue,o.False=new o.TruthValue,o.False["~"]=function(){return o.True},g["~"]=function(){return o.False},g.V=function(t){return t===o.True?t:this},g["^"]=function(t){return t===o.True?this:t},o.Statement=function(t,e,i){var r=[t,e];return r.operator=i,r.__proto__=o.Statement.prototype,r},g=e(o.Statement,o),g["="]=function(){},g["<"]=function(){},g.solve=function(t){var e=this.a["-"](this.b);return e.roots(t)},o.Constant=function(){throw Error("Expression.Constant created directly")},g=e(o.Constant,o),g.simplify=function(){return this},g.differentiate=function(){return _.Zero},g.default=function(t){return this["*"](t)},o.Symbol=function(t){this.symbol=t},g=e(o.Symbol,o),g.differentiate=function(t){return this===t?_.One:_.Zero},g.integrate=function(t){return this===t?new o.NumericalReal(.5,0)["*"](t["^"](new o.NumericalReal(2,0))):this["*"](t)},g.sub=function(t,e){return this===t?e:this},o.Symbol.Real=function(t){this.symbol=t},g=o.Symbol.Real.prototype=Object.create(o.Symbol.prototype),g.constructor=o.Symbol.Real,g.realimag=function(){return o.List.ComplexCartesian([this,_.Zero])},g.real=function(){return this},g.imag=function(){return _.Zero},g.polar=function(){return o.List.ComplexPolar([o.List.Real([_.abs,this]),o.List.Real([_.arg,this])])},g.abs=function(){return o.List.Real([_.abs,this])},g.arg=function(){return o.List.Real([_.arg,this])},g["+"]=function(t){return t==_.Zero?this:t instanceof o.NumericalReal?new o.List.Real([this,t],"+"):t instanceof o.Symbol.Real?new o.List.Real([this,t],"+"):t instanceof o.Symbol?new o.List([this,t],"+"):t["+"](this)},g["-"]=function(t){return this===t?_.Zero:t instanceof o.Symbol.Real?new o.List.Real([this,t],"-"):t instanceof o.List.Real?"@-"===t.operator?new o.List.Real([this,t[0]],"+"):new o.List.Real([this,t],"-"):t instanceof o.Symbol?new o.List([this,t],"-"):t["@-"]()["+"](this)},g["@+"]=function(){return o.List.Real([this],"@+")},g["@-"]=function(){return o.List.Real([this],"@-")},g["*"]=function(t){return t instanceof o.Rational&&t.a===t.b?this:t instanceof o.Rational&&0===t.a?_.Zero:t instanceof o.Symbol.Real?new o.List.Real([this,t],"*"):t instanceof o.List.Real?t["*"](this):t instanceof o.Symbol?new o.List([this,t],"*"):t instanceof o.NumericalReal?new o.List.Real([t,this],"*"):t instanceof o.NumericalComplex?new o.List.Real([this,t],"*"):t instanceof o.List.ComplexCartesian?t["*"](this):t["*"](this)},g.default=g["*"],g["/"]=function(t){if(t instanceof o.Rational&&t.a===t.b)return this;if(t instanceof o.Rational&&0===t.a)throw"Division by zero";return o.List.Real([this,t],"/")},g["^"]=function(t){if(t instanceof o.Rational&&0===t.a)return _.One;if(t instanceof o.Rational&&t.a===t.b)return this;if(t instanceof o.Integer)return o.List.Real([this,t],"^");if(t instanceof o.Rational){var e=t.reduce();if(0===e.a%2)return o.List.Real([this,t],"^")}return o.List([this,t],"^")},g["%"]=function(t){return o.List.Real([this,t],"%")},g.apply=function(t,e){throw"Real.apply"},o.Function=function(t){this.default=t.default,this["text/latex"]=t["text/latex"],this["x-shader/x-fragment"]=t["x-shader/x-fragment"],this["text/javascript"]=t["text/javascript"],this.derivative=t.derivative,this.realimag=t.realimag},g=e(o.Function,o),g.default=function(){},g.differentiate=function(){if(this.derivative)return this.derivative;throw"Function has no derivative defined."},g._s=function(t){if(this[t])return new m(this[t]);throw"Could not compile function into "+t},g["+"]=function(t){var e=new o.Symbol;return new o.Function.Symbolic(this.default(e)["+"](t),[e])},g["@-"]=function(){var t=new o.Symbol;return new o.Function.Symbolic(this.default(t)["@-"](),[t])},o.Function.Symbolic=function(t,e){this.expr=t,this.symbols=e},g=o.Function.Symbolic.prototype=Object.create(o.Function.prototype),g.constructor=o.Function.Symbolic,g.default=function(t){t.constructor!==o.Vector&&(t=o.Vector([t]));var e,i=this.expr,r=this.symbols.length;if(r!==t.length)throw"Invalid domain. Element of F^"+r+" expected.";for(e=0;r>e;e++)i=i.sub(this.symbols[e],t[e]);return i},o.NumericalComplex=function(t,e){this._real=t,this._imag=e},g=e(o.NumericalComplex,o.Constant),g.real=function(){return new o.NumericalReal(this._real)},g.imag=function(){return new o.NumericalReal(this._imag)},g.realimag=function(){return o.List.ComplexCartesian([new o.NumericalReal(this._real),new o.NumericalReal(this._imag)])},g.conjugate=function(){return new o.NumericalComplex(this._real,-this._imag)},g["+"]=function(t){if(0===this._real&&0===this._imag)return t;if(t instanceof o.NumericalComplex)return new o.NumericalComplex(this._real+t._real,this._imag+t._imag);if(t instanceof o.NumericalReal)return new o.NumericalComplex(this._real+t.value,this._imag);
if(t.constructor===o.List.ComplexCartesian)return t["+"](this);if(t.constructor===o.List.ComplexPolar)return t["+"](this);if(t.constructor===o.List.Real)return t["+"](this);if(t.constructor===o.Symbol.Real)return t["+"](this);if(t.constructor===o.List)return t["+"](this);throw"Unknown Type for NumericalComplex +"},g["-"]=function(t){if(0===this._real&&0===this._imag)return t["@-"]();if(t instanceof o.NumericalComplex)return new o.NumericalComplex(this._real-t._real,this._imag-t._imag);if(t.constructor===o.NumericalReal)return new o.NumericalComplex(this._real-t.value,this._imag);if(t.constructor===o.List.ComplexCartesian)return t["@-"]()["+"](this);if(t.constructor===o.List.ComplexPolar)return t["@-"]()["+"](this);if(t.constructor===o.List.Real)return t["@-"]()["+"](this);if(t.constructor===o.Symbol.Real)return t["@-"]()["+"](this);if(t.constructor===o.List)return t["@-"]()["+"](this);throw"Unknown Type for NumericalComplex -"},g["*"]=function(t){if(0===this._imag){if(0===this._real)return _.Zero;if(1===this._real)return t}if(t.constructor===this.constructor)return new o.NumericalComplex(this._real*t._real-this._imag*t._imag,this._real*t._imag+this._imag*t._real);if(t.constructor===o.NumericalReal)return new o.NumericalComplex(this._real*t.value,this._imag*t.value);if(t.constructor===o.List.ComplexCartesian)return t["*"](this);if(t.constructor===o.List.ComplexPolar)return t["*"](this);if(t.constructor===o.List.Real)return t["*"](this);if(t.constructor===o.Symbol.Real)return t["*"](this);if(t.constructor===o.List)return t["*"](this);throw"Unknown Type for NumericalComplex *"},g["/"]=function(t){if(0===this._imag&&0===this._real)return _.Zero;if(t.constructor===this.constructor){var e=t._real*t._real+t._imag*t._imag;return new o.NumericalComplex((this._real*t._real+this._imag*t._imag)/e,(this._imag*t._real-this._real*t._imag)/e)}if(t.constructor===o.NumericalReal)return new o.NumericalComplex(this._real/t.value,this._imag/t.value);if(t.constructor===o.List.ComplexCartesian)return this.realimag()["/"](t);if(t.constructor===o.List.ComplexPolar)return this.polar()["/"](t);if(t.constructor===o.List.Real)return o.List([this,t],"/");if(t.constructor===o.Symbol.Real)return o.List([this,t],"/");if(t.constructor===o.List)return o.List([this,t],"/");throw"Unknown Type for NumericalComplex /"},g["!"]=function(){return _.Gamma.default(this)},o.Conditional=function(e,i,r){return i instanceof o.Symbol.Real||i instanceof o.List.Real?new o.Conditional.Real(e,i,r):(this.cond=e,this.a=i,this.b=r||_.undefined,t)},g=e(o.Conditional,o),g.s=function(){throw"Not real... too confusing"},g.real=function(){return h(this,function(t){return t.real()})},g.imag=function(){return h(this,function(t){return t.imag()})},g.realimag=function(){return h(this,function(t){return t.realimag()})},g.differentiate=function(t){return h(this,function(e){return e.differentiate(t)})},o.Conditional.Real=function(t,e,i){this.cond=t,this.a=e,this.b=i||_.undefined},g=o.Conditional.Real.prototype=Object.create(o.Conditional.prototype),g.constructor=o.Conditional.Real,g.real=function(){return this},g.imag=function(){return _.Zero},g.realimag=function(){return new o.List.ComplexCartesian([this,_.Zero])},g.s=function(t){if("text/javascript"===t||"x-shader/x-fragment"==t){var e=this.a.s(t),i=this.b.s(t);console.log("code",e,i);var r=this.cond.s(t),n=e.s,s=e.merge(i);return s.merge(r,"("+r.s+") ? "+n+" : "+i.s)}},o.prototype.conjugate=function(){throw"Conjugate"},o.List.prototype.conjugate=function(){var t,e=this.length,i=Array(e);for(t=0;e>t;t++)i[t]=this[t].conjugate();return o.List(i,this.operator)},o.NumericalReal=function(t){this.value=t},g=e(o.NumericalReal,o.NumericalComplex),Object.defineProperty(g,"_real",{get:function(){return this.value}}),g._imag=0,g.real=function(){return this},g.imag=function(){return _.Zero},g.realimag=function(){return o.List.ComplexCartesian([this,_.Zero])},g.conjugate=function(){return this},g["+"]=function(t){return 0===this.value?t:t instanceof o.NumericalReal?new o.NumericalReal(this.value+t.value):t["+"](this)},g["@-"]=function(){return new o.NumericalReal(-this.value)},g["-"]=function(t){return 0===this.value?t:t instanceof o.NumericalReal?new o.NumericalReal(this.value-t.value):t["@-"]()["+"](this)},g["%"]=function(t){var e="The modular arithmetic operator '%' is not defined for non-real numbers.";if(0===this.value)return _.Zero;if(t instanceof o.NumericalReal)return new o.NumericalReal(this.value%t.value);if(t.constructor===o.List.Real)return o.List.Real([this,t],"%");if(t.constructor===o.Symbol.Real)return o.List.Real([this,t],"%");throw t.constructor===o.List?"Not sure about this...":t.constructor===o.NumericalComplex?new TypeError(e):t.constructor===o.List.ComplexCartesian?new TypeError(e):t.constructor===o.List.ComplexPolar?new TypeError(e):"Unknown Type for NumericalReal %"},g["*"]=function(t){return t instanceof o.NumericalReal?new o.NumericalReal(this.value*t.value):t["*"](this)},g["/"]=function(t){if(0===this.value)return _.Zero;if(t instanceof o.NumericalReal){if(0===t.value)throw"Division by zero not allowed!";return new o.NumericalReal(this.value/t.value)}if(t.constructor===o.NumericalComplex){var e=t._real*t._real+t._imag*t._imag;return new o.Complex(this.value*t._real/e,-this.value*t._imag/e)}if(t instanceof o.List.ComplexCartesian){var i=o.List.ComplexCartesian([t[0],t[1]["@-"]()]),r=o.NumericalReal(2);return i["*"](this)["/"](t[0]["^"](r)["+"](t[1]["^"](r)))}if(!(t instanceof o.List.ComplexPolar)){if(t instanceof o.List.Real)return o.List.Real([this,t],"/");if(t instanceof o.Symbol.Real)return o.List.Real([this,t],"/");if(t instanceof o.List)return o.List([this,t],"/");throw console.log("Unknown type: ",this,t),"Unknown Type for NumericalReal /"}},g["^"]=function(t){if(0===this.value)return _.Zero;if(1===this.value)return _.One;if(t===_.Zero)return _.One;if(t===_.One)return this;if(t instanceof o.Integer)return new o.NumericalReal(Math.pow(this.value,t.a));if(t instanceof o.NumericalReal){if(this.value>0)return new o.NumericalReal(Math.pow(this.value,t.value));var e=Math.pow(-this.value,t.value),i=Math.PI*t.value;return new o.List.ComplexPolar([new o.NumericalReal(e),new o.NumericalReal(i)])}if(t.constructor===o.NumericalComplex){var r=this.value,n=t._real,s=t._imag;console.error("Bad implementation ( num ^ complex)");var a=.5*Math.log(r*r),l=a*s,u=Math.exp(a*n);return new o.NumericalComplex(u*Math.cos(l),u*Math.sin(l))}if(t.constructor===o.List.ComplexCartesian)return o.List([this,t],"^");if(t.constructor===o.List.ComplexPolar)return o.List([this,t],"^");if(t.constructor===o.List.Real)return this.value>0?o.List.Real([this,t],"^"):o.List([this,t],"^");if(t.constructor===o.Symbol.Real)return this.value>0?o.List.Real([this,t],"^"):o.List([this,t],"^");if(t.constructor===o.List)return o.List([this,t],"^");throw console.error("Unknown Type for NumericalReal ^",t,t instanceof o.NumericalReal)},g[">"]=function(t){return t instanceof o.NumericalReal?this.value>t.value?o.True:o.False:g.__proto__[">"].call(this,t)},g["<"]=function(t){return t instanceof o.NumericalReal?this.value<t.value?o.True:o.False:g.__proto__["<"].call(this,t)},g["<="]=function(t){return t instanceof o.NumericalReal?this.value<=t.value?o.True:o.False:g.__proto__["<="].call(this,t)},g[">="]=function(t){return t instanceof o.NumericalReal?this.value>=t.value?o.True:o.False:g.__proto__[">="].call(this,t)},g.apply=function(e,i){switch(e){case",":return o.Vector([this,i]);case"^":if(0===this.value)return _.Zero;break;case"+":if(0===this.value)return i;break;case"-":if(0===this.value)return i.apply("@-");break;case t:case"*":if(1===this.value)return i;case"/":if(0===this.value)return _.Zero}if(i===t)switch(e){case"@+":return this;case"@-":return new o.NumericalReal(-this.value);case"++":case"--":throw new TypeError("Postfix "+e+" operator applied to value that is not a reference.");case"+=":case"-=":case"*=":case"/=":throw new ReferenceError("Left side of assignment is not a reference.");case"!":return _.Gamma.apply(t,new o.NumericalReal(this.value+1))}else if(i.constructor===this.constructor)switch(e){case"*":case t:return new o.NumericalReal(this.value*i.value);case"+":return new o.NumericalReal(this.value+i.value);case"-":return new o.NumericalReal(this.value-i.value);case"/":return new o.NumericalReal(this.value/i.value);case"^":if(this.value>0)return new o.NumericalReal(Math.pow(this.value,i.value));var r=Math.pow(-this.value,i.value),n=Math.PI*i.value;return new o.Complex(r*Math.cos(n),r*Math.sin(n));default:}else if(i.constructor===o.Complex)switch(e){case"*":case t:return new o.Complex(this.value*i._real,this.value*i._imag);case"+":return new o.Complex(this.value+i._real,i._imag);case"-":return new o.Complex(this.value-i._real,-i._imag);case"/":var s=i._real*i._real+i._imag*i._imag;return new o.Complex(this.value*i._real/s,-this.value*i._imag/s);case"^":var a=this.value,l=i._real,u=i._imag;console.error("Bad implementation ( num ^ complex)");var c=.5*Math.log(a*a),h=c*u,f=Math.exp(c*l);return new o.Complex(f*Math.cos(h),f*Math.sin(h));default:}else if(i.constructor===o.List.ComplexCartesian)switch(e){case"+":case"-":return o.List.ComplexCartesian([i[0].apply(e,this),i[1]]);case t:e="*";case"*":case"/":return o.List.ComplexCartesian([i[0].apply(e,this),i[1].apply(e,this)]);case"^":return console.warn("ineffecient: NR ^ CL"),this.realimag().apply(e,i)}else if(i.constructor===o.List.ComplexPolar)switch(e){case"+":case"-":case"^":return o.List([this,i],e);case t:e="*";case"*":return o.List.ComplexPolar([i[0].apply(e,this),i[1]]);case"/":return o.List.ComplexPolar([i[0].apply(e,this),i[1]])}else if(i.constructor===o.List.Real)switch(e){case t:e="*";case"*":case"+":case"-":case"/":return o.List.Real([this,i],e);case"^":if(0===this.value)throw"N(0) ^ x";return this.value>0?o.List.Real([this,i],e):o.List.ComplexPolar([new o.Numerical(-this.value).apply("^",i),_.pi.apply("*",i)])}else if(i.constructor===o.Symbol.Real)switch(e){case t:e="*";case"*":case"+":case"-":case"/":return o.List.Real([this,i],e);case"^":if(0===this.value)throw"N(0) ^ x";return this.value>0?o.List.Real([this,i],e):o.List.ComplexPolar([o.List.Real([new o.NumericalReal(-this.value),i],"^"),_.pi.apply("*",i)])}throw"?? - real"},o.Rational=function(t,e){this.a=t,this.b=e},g=e(o.Rational,o.NumericalReal),g.__defineGetter__("value",function(){return this.a/this.b}),g["+"]=function(t){return 0===this.a?t:t instanceof o.Rational?new o.Rational(this.a*t.b+this.b*t.a,this.b*t.b):t.constructor===o.NumericalComplex?new o.NumericalComplex(this.value+t._real,t._imag):t.constructor===o.List.ComplexCartesian?t["+"](this):t.constructor===o.List.ComplexPolar?t["+"](this):t.constructor===o.List.Real?t["+"](this):t.constructor===o.Symbol.Real?t["+"](this):t.constructor===o.List?t["+"](this):(console.warn("Swapped operator order for + with Rational"),t["+"](this))},g["-"]=function(t){return 0===this.a?t["@-"]():t instanceof o.Rational?new o.Rational(this.a*t.b-this.b*t.a,this.b*t.b):t.constructor===o.NumericalComplex?new o.NumericalComplex(this.value-t._real,t._imag):t.constructor===o.List.ComplexCartesian?t["@-"]()["+"](this):t.constructor===o.List.ComplexPolar?t["@-"]()["+"](this):t.constructor===o.List.Real?t["@-"]()["+"](this):t.constructor===o.Symbol.Real?t["@-"]()["+"](this):t.constructor===o.List?t["@-"]()["+"](this):(console.warn("Swapped operator order for - with Rational"),t["+"](this))},g["*"]=function(t){return 0===this.a?_.Zero:t instanceof this.constructor?new o.Rational(this.a*t.a,this.b*t.b):this.__proto__.__proto__["*"].call(this,t)},g["/"]=function(t){if(0===this.a)return _.Zero;if(t instanceof this.constructor){if(0===t.a)throw"Division By Zero is not defined for Rational numbers!";return new o.Rational(this.a*t.b,this.b*t.a).reduce()}return o.NumericalReal.prototype["/"].call(this,t)},g["^"]=function(t){if(t===_.Zero)return _.One;if(t===_.One)return this;if(0===this.a)return _.Zero;if(this.a===this.b)return _.One;if(t instanceof o.Integer)return new o.Rational(Math.pow(this.a,t.a),Math.pow(this.b,t.a));if(t instanceof o.Rational){var e=t.reduce();return 0==e.a%2?new o.NumericalReal(Math.pow(Math.pow(this.a,e.a),1/e.b)):o.NumericalReal.prototype["^"].call(this,t)}return o.List([this,t],"^")},g.reduce=function(){function t(e,i){return 0===i?e:t(i,e%i)}var e=t(this.b,this.a);return this.a/=e,this.b/=e,1===this.b?new o.Integer(this.a):(0>this.b&&(this.a=-this.a,this.b=-this.b),this)},o.Integer=function(t){this.a=t},g=e(o.Integer,o.Rational),g.b=1,g["+"]=function(t){return t instanceof o.Integer?new o.Integer(this.a+t.a):t["+"](this)},g["-"]=function(t){return t instanceof o.Integer?new o.Integer(this.a-t.a):this.__proto__.__proto__["-"].call(this,t)},g["/"]=function(t){return t instanceof o.Integer?0===this.a%t.a?new o.Integer(this.a/t.a):new o.Rational(this.a,t.a):this.__proto__.__proto__["/"].call(this,t)},g["@-"]=function(){return new o.Integer(-this.a)},g["*"]=function(t){return t instanceof o.Integer?new o.Integer(this.a*t.a):t["*"](this)},g["^"]=function(t){if(t instanceof o.Integer)return new o.Integer(Math.pow(this.a,t.a));if(t.constructor===o.Rational){var e=t.reduce();return 0==e.a%2?new o.NumericalReal(Math.pow(Math.pow(this.a,e.a),1/e.b)):o.NumericalReal.prototype["^"].call(this,t)}return(t.constructor===o.List.Real||t.constructor===o.Symbol.Real)&&this.a>0?o.List.Real([this,t],"^"):o.NumericalReal.prototype["^"].call(this,t)},g["%"]=function(t){return t instanceof o.Integer?new o.Integer(this.a%t.a):t.constructor===o.Rational?new o.Rational:t.constructor===o.NumericalReal?new o.NumericalReal(this%t.value):o.List.Real([this,t],"%")},o.List.prototype.differentiate=function(e){switch(this.operator){case t:if(this[0]instanceof o.Function){var i=this[1].differentiate(e);return i===_.Zero?i:this[0].differentiate().default(this[1])["*"](i)}case"*":return this[0].differentiate(e)["*"](this[1])["+"](this[1].differentiate(e)["*"](this[0]));case"@+":case"@-":return this[0].differentiate(e)[this.operator]();case"+":case"-":return this[0].differentiate(e)[this.operator](this[1].differentiate(e));case"^":var r=this[0].differentiate(e),n=this[1].differentiate(e);if(r===_.Zero)return n===_.Zero?_.Zero:n["*"](_.log.default(this[0]))["*"](this);var s=this[0]["^"](this[1]["-"](_.One));return s["*"](r["*"](this[1])["+"](this[0]["*"](_.log.default(this[0]))["*"](n)));case"/":var i=this[0].differentiate(e),a=this[1].differentiate(e);return a===_.Zero?i["/"](this[1]):this[1]["*"](i)["-"](this[0]["*"](a))["/"](this[1]["^"](new o.Integer(2)));default:throw"Cannot differentiate "+this.operator+" operator."}},o.prototype.differentiateN=function(e,i){return 0===i?this:-1>=i?this.integrateN(e,i):i>1?this.differentiate(e).differentiateN(e,i-1):1===i?this.differentiate(e):t},o.Root=function(t,e){this.a=t,this.n=e},g=o.Root.prototype=Object.create(o.NumericalReal),g.constructor=o.Root,g["*"]=function(e){return e.constructor!==this.constructor?e["*"](this):t},g.__defineGetter__("value",function(){return Math.pow(this.a,1/this.n)}),o.Equation=function(t,e){return t.__proto__=o.Equation.prototype,t.operator=e,t},g=o.Equation.prototype=Object.create(o.List.prototype),g.apply=function(){throw"Operators cannot be applied to equations"},o.prototype.real=function(){return console.warn("TODO: don't calculate both parts (Expression.prototype.real)"),this.realimag()[0]},o.prototype.imag=function(){return console.warn("TODO: don't calculate both parts (Expression.prototype.imag)"),this.realimag()[1]},o.List.prototype.realimag=function(){switch(console.error("Only the user can call this function"),this.operator){case t:if(this[0]instanceof o.Function)return this[0].realimag().default(this[1]);case"*":var e=this[0].realimag(),i=this[1].realimag();return o.List.ComplexCartesian([e[0]["*"](i[0])["-"](e[1]["*"](i[1])),e[0]["*"](i[1])["+"](e[1]["*"](i[0]))]);case"@+":case"@-":var e=this[0].realimag();return o.List.ComplexCartesian([e[0][this.operator](),e[1][this.operator]()]);case"+":case"-":var e=this[0].realimag(),i=this[1].realimag();return o.List.ComplexCartesian([e[0][this.operator](i[0]),e[1][this.operator](i[1])]);case"/":var e=this[0].realimag(),i=this[1].realimag(),r=i[0]["*"](i[0])["+"](i[1]["*"](i[1]));return o.List.ComplexCartesian([e[0]["*"](i[0])["+"](e[1]["*"](i[1]))["/"](r),e[1]["*"](i[0])["-"](e[0]["*"](i[1]))["/"](r)]);case"^":var e=this[0].realimag(),i=this[1].realimag();new o.Rational(1,2),new o.Integer(2);var n=_.log.realimag().default(e),s=n[0],a=n[1],l=s["*"](i[1])["+"](a["*"](i[0])),u=_.e["^"](s["*"](i[0])["-"](a["*"](i[1])));return o.List.ComplexCartesian([u["*"](_.cos.default(l)),u["*"](_.sin.default(l))])}},o.List.ComplexPolar=function(t){return t.__proto__=o.List.ComplexPolar.prototype,t},g=e(o.List.ComplexPolar,o),g.polar=function(){return this},g.realimag=function(){return o.List.ComplexCartesian([this[0].apply("*",_.cos.apply(t,this[1])),this[0].apply("*",_.sin.apply(t,this[1]))])},g.real=function(){return this[0].apply("*",_.cos.apply(t,this[1]))},g.imag=function(){return this[0].apply("*",_.sin.apply(t,this[1]))},g.conjugate=function(){return o.List.ComplexPolar([this[0],this[1].apply("@-")])},g.differentiate=function(t){return _.e.apply("^",_.i.apply("*",this[1])).apply("*",this[0].differentiate(t).apply("+",_.i.apply("*",this[0]).apply("*",this[1].differentiate(t))))},g.apply=function(e,i){if(i.constructor===this.constructor)switch(e){case t:case"*":return o.List.ComplexPolar([this[0].apply("*",i[0]),this[1].apply("+",i[1])]);case"/":return o.List.ComplexPolar([this[0].apply("/",i[0]),this[1].apply("-",i[1])]);case"+":case"-":case"^":case"!":default:}else if(i.constructor===o.NumericalReal)switch(e){case t:case"*":return o.List.ComplexPolar([this[0].apply("*",i),this[1]]);case"/":return o.List.ComplexPolar([this[0].apply("/",i),this[1]]);case"+":case"-":case"^":return o.List.ComplexPolar([this[0],this[1].apply("*",i)]);case"!":default:}else if(i.constructor===o.Complex)switch(e){case t:case"*":return o.List.ComplexPolar([this[0].apply("*",new o.NumericalReal(i._real)),this[1].apply("+",new o.NumericalReal(i._imag))]);case"/":return o.List.ComplexPolar([this[0].apply("/",new o.NumericalReal(i._real)),this[1].apply("-",new o.NumericalReal(i._imag))]);case"+":case"-":case"^":case"!":default:}},g.abs=function(){return this[0]},g.arg=function(){return this[1]},o.List.ComplexCartesian=function(t){return t.__proto__=o.List.ComplexCartesian.prototype,t},g=e(o.List.ComplexCartesian,o),g.realimag=function(){return this},g.real=function(){return this[0]},g.imag=function(){return this[1]},g.conjugate=function(){return o.List.ComplexCartesian([this[0],this[1].apply("@-")])},g["@-"]=function(){return new o.List.ComplexCartesian([this[0]["@-"](),this[1]["@-"]()])},g["*"]=function(e){return e instanceof o.List.ComplexCartesian?new o.List.ComplexCartesian([this[0]["*"](e[0])["-"](this[1]["*"](e[1])),this[0]["*"](e[1])["+"](this[1]["*"](e[0]))]):e instanceof o.List.Real||e instanceof o.Symbol.Real||e instanceof o.NumericalReal?new o.List.ComplexCartesian([this[0]["*"](e),this[1]["*"](e)]):t},g["^"]=function(t){if(t instanceof o.Integer){if(t instanceof o.Rational&&t.a===t.b)return this;if(t instanceof o.Rational&&0===t.a)return _.One;var e,i=t.a,t=this[0],r=this[1];new o.Integer(-1);var n=_.Zero,s=t["^"](new o.Integer(i)),a=1;for(e=1;;e++){if(e===i){var l=r["^"](new o.Integer(e));0===a?s=s["+"](l):1===a?n=n["+"](l):2===a?s=s["-"](l):3===a&&(n=n["-"](l),a=-1);break}var l=t["^"](new o.Integer(i-e))["*"](r["^"](new o.Integer(e)));0===a?s=s["+"](l):1===a?n=n["+"](l):2===a?s=s["-"](l):3===a&&(n=n["-"](l),a=-1),a++}return new o.List.ComplexCartesian([s,n])}return new o.List([this,t],"^")},g["+"]=function(e){return e instanceof o.List.ComplexCartesian?new o.List.ComplexCartesian([this[0]]):e instanceof o.List.Real||e instanceof o.Symbol.Real||e instanceof o.NumericalReal?new o.List.ComplexCartesian([this[0]["+"](e),this[1]]):t},g.differentiate=function(t){return o.List.ComplexCartesian([this[0].differentiate(t),this[1].differentiate(t)])},g.apply=function(e,i){if(i.constructor===this.constructor)switch(e){case"+":case"-":return o.List.ComplexCartesian([this[0].apply(e,i[0]),this[1].apply(e,i[1])]);case t:case"*":return o.List.ComplexCartesian([this[0].apply("*",i[0]).apply("-",this[1].apply("*",i[1])),this[0].apply("*",i[1]).apply("+",this[1].apply("*",i[0]))]);case"/":var r=i[0].apply("*",i[0]).apply("+",i[1].apply("*",i[1]));return o.List.ComplexCartesian([this[0].apply("*",i[0]).apply("+",this[1].apply("*",i[1])).apply("/",r),this[1].apply("*",i[0]).apply("-",this[0].apply("*",i[1])).apply("/",r)]);case"^":var n=new o.NumericalReal(.5,0),s=n.apply("*",_.log.apply(t,this[0].apply("*",this[0]).apply("+",this[1].apply("*",this[1])))),l=_.atan2.apply(t,o.Vector([this[1],this[0]])),u=s.apply("*",i[1]).apply("+",l.apply("*",i[0])),c=_.e.apply("^",s.apply("*",i[0]).apply("-",l.apply("*",i[1])));return o.List.ComplexCartesian([c.apply("*",_.cos.apply(t,u)),c.apply("*",_.sin.apply(t,u))]);case"!":default:}else if(i.constructor===o.List.ComplexPolar)switch(e){case"*":case"/":var r=i[0].apply("*",i[0]),h=i.realimag();return o.List.ComplexCartesian([this[0].apply("*",h[0]).apply("+",a[1].apply("*",h[1])).apply("/",r),this[1].apply("*",h[0]).apply("-",a[0].apply("*",h[1])).apply("/",r)]);case"^":case"+":case"-":return this.apply(e,i.realimag())}else{if(i.constructor===o.Complex)return this.apply(e,i.realimag());if(i.constructor===o.Symbol.Real)return console.error("Duplicated an x! This makes it difficult to solve complex equations, I think"),this.apply(e,i.realimag());if(i.constructor===o.List.Real)return console.error("Duplicated an x! This makes it difficult to solve complex equations, I think"),this.apply(e,i.realimag())}throw"CMPLX.LIST * "+e},o.List.Real=function(e,i){return e.__proto__=o.List.Real.prototype,i!==t&&(e.operator=i),e},g=e(o.List.Real,o.List),g.realimag=function(){return o.List.ComplexCartesian([this,_.Zero])},g.real=function(){return this},g.imag=function(){return _.Zero},g.polar=function(){return o.List.ComplexPolar([o.List.Real([_.abs,this]),o.List.Real([_.arg,this])])},g.abs=function(){return o.List.Real([_.abs,this])},g.arg=function(){return o.List.Real([_.arg,this])},g["+"]=function(t){return this===t?t["*"](new o.Integer(2)):t instanceof o.Rational&&0===t.a?this:t instanceof o.NumericalReal?"+"===this.operator&&this[1]instanceof o.NumericalReal?o.List.Real([this[0],this[1]["+"](t)],this.operator):"-"===this.operator&&this[1]instanceof o.NumericalReal?o.List.Real([this[0],t["-"](this[1])],"+"):o.List.Real([this,t],"+"):t instanceof o.List.Real||t instanceof o.Symbol.Real?o.List.Real([this,t],"+"):t["+"](this)},g["-"]=function(t){return t instanceof o.Rational&&0===t.a?this:t===this?_.Zero:t instanceof o.List.Real?"@-"===t.operator?o.List.Real([this,t[0]],"+"):o.List.Real([this,t],"-"):t instanceof o.Symbol.Real||t instanceof o.NumericalReal?o.List.Real([this,t],"-"):this.realimag()["-"](t)},g["*"]=function(t){return t instanceof o.Rational&&t.a===t.b?this:t instanceof o.Rational&&0===t.a?_.Zero:t instanceof o.NumericalReal?"*"===this.operator||"/"===this.operator&&this[0]instanceof o.NumericalReal?o.List.Real([this[0]["*"](t),this[1]],this.operator):o.List.Real([t,this],"*"):t instanceof o.List.Real||t instanceof o.Symbol.Real?(this[0]instanceof o.Function,o.List.Real([this,t],"*")):t["*"](this)},g["/"]=function(t){return t instanceof o.Rational&&t.a===t.b?this:t===this?_.One:t instanceof o.NumericalReal?"*"===this.operator||"/"===this.operator?o.List.Real([this[0]["/"](t),this[1]],this.operator):o.List.Real([this,t],"/"):t instanceof o.List.Real||t instanceof o.Symbol.Real?o.List.Real([this,t],"/"):this.realimag()["/"](t)},g["%"]=function(t){return o.List.Real([this,t],"%")},g["@-"]=function(){return"@-"===this.operator?this[0]:o.List.Real([this],"@-")},g["^"]=function(t){return t instanceof o.NumericalReal&&("*"===this.operator||"/"===this.operator&&this[0]instanceof o.NumericalReal)?o.List.Real([this[0]["^"](t),this[1]["^"](t)],this.operator):o.Symbol.Real.prototype["^"].call(this,t)},o.prototype.polar=function(){var t=this.realimag(),e=new o.Integer(2);return o.List.ComplexPolar([_.sqrt.default(t[0]["^"](e)["+"](t[1]["^"](e))),_.atan2.default(o.Vector([t[1],t[0]]))])},o.prototype.abs=function(){console.warn("SLOW?");var t=this.realimag(),e=new o.Integer(2);return _.sqrt.default(t[0]["^"](e)["+"](t[1]["^"](e)))},o.prototype.arg=function(){console.warn("Slow?");var t=this.realimag();return _.atan2.default(o.Vector([t[1],t[0]]))},o.prototype.factors=function(t,e,i){i(this,!1)},o.prototype.terms=function(t,e,i){i(this,!1)},o.prototype.factorize=function(t){throw"Inefficent"},o.Symbol.Real.prototype.factors=function(t,e,i){-1!==t.indexOf(this)?e(this,!1):i(this,!1)},o.Symbol.Real.prototype.terms=function(t,e,i){-1!==t.indexOf(this)?e(this,!1):i(this,!1)},o.List.Real.prototype.terms=function(e,i,r){switch(this.operator){case"+":return this[0].terms(e,i,r),this[1].terms(e,i,r),t;case"-":return this[0].terms(e,i,r),this[1].terms(e,function(t){i(t["@-"]())},function(t){r(t["@-"]())}),t;case"*":var n=[],s=_.Zero,a=[],l=_.Zero;this[0].terms(e,function(t){n.push(t)},function(t){s=s["*"](t)}),this[1].terms(e,function(t){a.push(t)},function(t){l=l["*"](t)}),r(s["*"](l));var u=0;for(u=0;n.length>u;u++){var c;for(c=0;a.length>c;c++)i(n[u]["*"](a[c]))}return;case"/":var h=this;if(this[1]instanceof o.Constant)return this[0].terms(e,function(t){i(t["/"](h[1]))},function(t){r(t["/"](h[1]))}),t;throw"Expansion in denominator required"}},o.List.Real.prototype.factors=function(e,i,r,n){var s=~~(1e3*Math.random());switch(console.log("("+s+") Attempt to find factors of: ",this),this.operator){case"-":case"+":var a=[],o=_.One,l=[],u=_.One;this[0].factors(e,function(t){console.log(s+"< a: ",t),a.push(t)},function(t){console.log(s+"< a_c: ",t),o=o["*"](t)}),this[1].factors(e,function(t){console.log(s+"< b: ",t),l.push(t)},function(t){console.log(s+"< b_c: ",t),u=u["*"](t)});var c,h,f=[],p=a.length,m=l.length,y=_.One,g=_.One;for(c=0;p>c;c++){var d=!1;for(h=0;m>h;h++)if(l[h]!==t&&a[c]===l[h]){f.push(a[c]),l[h]=t,d=!0;break}d||(y=y["*"](a[c]))}for(h=0;m>h;h++)l[h]!==t&&(g=g["*"](l[h]));return f.length?(console.log("common:",f,"of: ",a,l),f.forEach(i),console.log("(a,b) = ",y,g),console.log("(a_c,b_c) = ",o,u),i(y["*"](o)["+"](g["*"](u)))):r(this),t;case"*":return this[0].factors(e,i,r),this[1].factors(e,i,r),t;case"/":if(this[0].factors(e,i,r),n===!1)return;return this[1].factors(e,function(t,e){i(t,!e)},function(t,e){r(t,!e)}),t}},o.prototype.roots=function(){return u([])},o.Symbol.prototype.roots=function(t){return-1!==t.indexOf(this)?u([new Statement(this,_.Zero,"=")]):u([])},o.prototype.dep=function(){return!1},o.Symbol.Real.prototype.dep=function(t){return-1!==t.indexOf(this)},o.List.prototype.dep=function(t){return this[0].dep(t)?!0:this.operator&&"@"===this.operator[0]?!1:this[1].dep(t)?!0:!1},o.Function.Symbolic.prototype.inverse=function(){},o.List.Real.prototype.roots=function(t){if("*"===this.operator){var e=this[0].roots(t),i=this[1].roots(t);return e.union(i)}if("+"===this.operator){var r=_.One;if(this.factors(t,function(t){r=r["*"](t)},function(){},!1),"*"===r.operator)return r.roots(t);if(this[1].dep(t)){if(this[0].dep(t))throw"Cannot solve"}else;this[0].roots(t),this[0].roots(t)}else if("/"===this.operator){var e=this[0].roots(t);return e}},g=e(f,o),g["+"]=function(t){if(t instanceof f)throw"Infinitesimal addition";return t},g["/"]=function(t){if(t instanceof f){if(t.x instanceof o.Symbol)return this.x.differentiate(t.x);throw"Confusing infitesimal division"}return this.x=this.x["/"](t),this},g["*"]=function(e){return e instanceof f?_.Zero:(this.x=this.x["*"](e),t)},g.s=function(t){if("text/latex"!==t)throw"Infinitesimal numbers cannot be exported to programming languages";var e=this.x.s(t),i=N.precedence("default");return i>e.p&&(e.s="\\left("+e.s+"\\right)"),e.update("d"+e.s,i)},g=e(p,o.Function),g.default=function(t){return t.differentiate(this.x)},o.List.prototype.lim=function(t,e){switch(this.operator){case"+":case"-":return this[0].lim(t,e)[this.operator](this[1].lim(t,e));case"@-":case"@+":return this[0].lim(t,e)[this.operator]();case"/":var i=this[0].sub(t,e),r=this[1].sub(t,e);return i===_.Zero&&r===_.Zero?(i=this[0].differentiate(t),r=this[1].differentiate(t),i["/"](r).lim(t,e)):i["/"](r);case"*":var n=this[0].sub(t,e),s=this[1].sub(t,e);if(n===_.Zero&&s==_.Infinity){var i=this[0].differentiate(t),r=_.One["/"](this[1]).differentiate(t);return i["/"](r).lim(t,e)}if(s===_.Zero&&n==_.Infinity){var i=this[0].differentiate(t),r=_.One["/"](this[1]).differentiate(t);return i["/"](r).lim(t,e)}return n["*"](s);case"^":return this[0]===_.Zero?_.Zero:this[1]===_.Zero&&this[0]!==_.Zero?_.One:this.sub(t,e);case"!":return this.sub(t,e)}},o.Vector=function(t){return t.__proto__=o.Vector.prototype,t},g=e(o.Vector,o),g[",."]=function(t){return o.Vector(Array.prototype.concat.call(this,[t]))},g.differentiate=function(t){return o.Vector(Array.prototype.map.call(this,function(e){return e.differentiate(t)}))},g.cross=function(t){if(3!==this.length||3!==t.length)throw"Cross product only defined for 3D vectors.";return new o.Vector([this[1].default(t[2])["-"](this[2].default(t[1])),this[2].default(t[0])["-"](this[0].default(t[2])),this[0].default(t[1])["-"](this[1].default(t[0]))])},g[x]=g.cross,g.default=function(e){var i=this.length;if(e instanceof o.Vector){if(i!==e.length)throw"Vector Dimension mismatch.";var r,n=_.Zero;for(r=0;i>r;r++)n=n["+"](this[r].default(e[r]));return n}return e instanceof o.Matrix?t:o.Vector(Array.prototype.map.call(this,function(t){return t.default(e)}))},g["*"]=g.default,g["+"]=function(t,e){var i=this.length;if(i!=t.length)throw new r("Vector Dimension mismatch.");var n,s=Array(i);for(n=0;i>n;n++)s[n]=this[n][e||"+"](t[n]);return o.Vector(s)},g["-"]=function(t){return this["+"](t,"-")},g["/"]=function(t){if(t instanceof o.Vector)throw"Vector division not defined";return o.Vector(Array.prototype.map.call(this,function(e){return e["/"](t)}))},g["^"]=function(t){if(t instanceof o.Integer){if(0===t.a)throw"Raised to zero power";if(1===t.a)return this;if(2===t.a){var e,i=_.Zero,r=this.length;for(e=0;r>e;e++)i=i["+"](this[e]["^"](t));return i}return this["^"](new o.Integer(t.a-1))["*"](this)}if(t instanceof o.Rational)return this["^"](t.a)["^"](_.One["/"](t.b));if(t.constructor===o.NumericalComplex)return new o.Complex(this.value+t._real,t._imag);if(t.constructor===o.List.ComplexCartesian)return t["+"](this);if(t.constructor===o.List.ComplexPolar)return t["+"](this);if(t.constructor===o.List.Real)return t["+"](this);if(t.constructor===o.Symbol.Real)return t["+"](this);if(t.constructor===o.List)return t["+"](this);throw"Unknown Type for Vector ^"},g.apply=function(e,i){var r=this.length;switch(e){case",":return this[r]=i,this;case t:case"*":if(r!=i.length)throw"Vector Dimension mismatch.";var n,s=y.Global.Zero;for(n=0;r>n;n++)s=s.apply("+",this[n].apply("*",i[n]));return s;case"+":case"-":if(r!=i.length)throw"Vector Dimension mismatch.";var n,a=Array(r);for(n=0;r>n;n++)a[n]=this[n].apply(e,i[n]);return o.Vector(a);case"/":case"^":default:throw"Vector operation not allowed."}},g.realimag=function(){var t,e=this.length,i=Array(e),r=Array(e);for(t=0;e>t;t++){var n=this[t].realimag();i[t]=n[0],r[t]=n[1]}return o.List.ComplexCartesian([o.Vector(i),o.Vector(r)])},o.Matrix=function(t,e,i){return t.__proto__=o.Matrix.prototype,t.rows=e,t.cols=i,t},g=e(o.Matrix,o),g.default=g["*"]=function(t){if(t.constructor===o.Matrix){if(t.rows!==this.cols)throw"Matrix dimensions do not match.";var e,i,r,n=[],s=0;for(e=0;this.rows>e;e++)for(i=0;t.cols>i;i++){var a=_.Zero;for(r=0;t.rows>r;r++)a=a["+"](t[r*t.cols+i]);n[s++]=a}return o.Matrix(n)}throw"Unknown type"},g.reduce=function(){var t,e;for(e=0;this.rows>e;e++)for(t=0;e>t;t++){var i=this[t*this.cols+t];if(i===_.Zero)throw"Row swap!";var r,n=this[e*this.cols+t]["/"](i);for(r=t+1;this.cols>r;r++)this[e*this.cols+r]=this[e*this.cols+r]["-"](n["*"](this[t*this.cols+r]))
}return this},o.Sum=function(t,e,i,r){this.x=t,this.f=r,this.a=e,this.b=i},g=e(o.Sum,o.Symbol.Real),o.Sum.Real=function(t,e,i,r){if(this.x=t,this.f=r,this.a=e,this.b=i,!(this.x instanceof o.Symbol.Real))throw"Can only sum over reals in javascript"},g=o.Sum.Real.prototype=Object.create(o.Sum.prototype),g.constructor=o.Sum.Real,g.real=function(){return this},g.realimag=function(){return new o.List.ComplexCartesian([this,_.Zero])},g.s=function(t){if("text/latex"===t){var e=this.f.s(t),i=this.a.s(t),r=this.b.s(t),n=this.x.s(t),s=e.s,a=e;return a=e.merge(i),a=e.merge(r),a.merge(n,"\\sum_{"+n.s+"="+i.s+"}^{"+r.s+"}"+s,N.precedence("*"))}if("text/javascript"===t){var i=this.a.s(t),r=this.b.s(t);if(!(this.x instanceof o.Symbol.Real))throw"Can only sum over reals in javascript";var n=this.x.s(t),a=n.merge(i).merge(r),l=a.var(),u=a.var(),c=a.var(),h=a.var(),f=this.f.sub(this.x,new o.Symbol.Real(l)),e=f.s(t),p="var "+u+" = 0, "+l+", "+h+" = "+i.s+", "+c+" = "+r.s+";\nif("+c+" === Infinity) {\n	"+c+" = 1000;\n}\nif (!("+c+" >= "+h+')) {\n	throw("Halting problem solved.")\n}\nfor('+l+" = "+h+"; "+l+" < "+c+"; "+l+"++) {\n	"+u+" +="+e.s+";\n}\n";return a.merge(e,u,1/0,p)}if("x-shader/x-fragment"===t){var i=this.a.s(t),r=this.b.s(t);if(!(this.x instanceof o.Symbol.Real))throw"Can only sum over reals in GLSL";var n=this.x.s(t),a=n.merge(i).merge(r),l=a.var(),u=a.var(),f=this.f.sub(this.x,new o.Symbol.Real(l)),e=f.s(t);"int("+i.s+")","int("+r.s+")";var p="float "+u+" = 0.0;\nfor(float "+l+" = "+i.s+"; "+l+" < "+r.s+"; "+l+"+=1.0) {\n	"+u+" += "+" + "+e.s+";\n}\n";return a.merge(e,u,1/0,p)}},g["^"]=function(t){if(this.b_locked)throw"Sum was upper bounded twice!";return this.b=t,this.b_locked=!0,this},g.default=function(t){if(!this.b_locked)throw"Sum was not upper bounded!";if(this.f_locked)throw"Sum already defined";return this.f=t,this.f_locked=!0,this},o.List.prototype.expand=function(t){{_.Zero,_.Zero}throw"Should be async, don't use this"},o.prototype.simplify=function(){return this},o.prototype.integrate=function(){throw"Could not integrate expression."},o.prototype.integrateN=function(e,i){return 0===i?this:-1>=i?this.differentiateN(e,i):i>1?this.integrate(e).integrateN(e,i-1):1===i?this.integrate(e):t};var S={"void":1,vec3:2,bool:6,"int":3,fp:4,vec2:5,vec4:7,mat2:10,mat3:11,mat4:12,func:20},I={Boolean:1,Number:2,String:3,undefined:4,Object:5,Function:S.func,Array:7,ref:8};g=m.prototype,m.newContext=function(){m.contextVariableCount=0},m.newContext(),g.var=function(){return"t"+(m.contextVariableCount++).toString(36)},g.merge=function(t,e,i,r){return this.s=e,r&&this.pre.push(r),this.pre.push.apply(this.pre,t.pre),this.vars+=t.vars,this.p=i,this},g.update=function(t,e,i){return this.p=e,i&&this.pre.push(i),this.s=t,this},g.compile=function(t){return Function(t,this.pre.join("\n")+"return "+this.s)},g.glslFunction=function(t,e,i){return t+" "+e+"("+i+"){\n"+this.pre.join("\n")+"return "+this.s+";\n}\n"},o.List.prototype._s=function(t){if("text/latex"===t)return o.List.Real.prototype._s.call(this,t);throw"Use real(), imag(), or abs(), or arg() first."},o.List.Real.prototype._s=function(e){function i(t){return"text/latex"===e?"\\left("+t+"\\right)":"("+t+")"}function r(t){return h>t.p?i(t.s):t.s}if(this.operator===t){if(this[0]instanceof o.Function){if(this[0]===_.abs){var n=this[1]._s(e);if("text/latex"===e)return n.update("\\left|"+n.s+"\\right|",1/0);var s=this[0]._s(e);return n.update(s.s+"("+n.s+")",1/0)}var s=this[0]._s(e);if(this[1]instanceof o.Vector){var a,l=Array.prototype.map.call(this[1],function(t){return t._s(e)}),u=l.map(function(t){return t.s});this[0]===_.atan&&(u=u.reverse());var c=s.s;for(a=0;l.length>a;a++)s.merge(l[a]);return s.update(c+i(u),N.precedence("default"))}var n=this[1]._s(e);return s.merge(n,s.s+i(n.s),N.precedence("default"))}this.operator="*"}var h=N.precedence(this.operator);if("^"===this.operator){if("x-shader/x-fragment"===e){if(this[0]===_.e){var n=this[1]._s(e);return n.update("exp("+n.s+")")}if(this[1]instanceof o.Integer&&5>this[1].a&&this[1].a>-1){var s=this[0]._s(e);N.precedence("*");var f,p=t;this[0]instanceof o.Symbol?f=s.s:(f=s.var(),p="float "+f+" = "+s.s+";");var a,m=f;for(a=1;this[1].a>a;a++)m+="*"+f;return s.update("("+m+")",1/0,p)}if(this[1]instanceof o.Integer&&-1==this[1].a){var s=this[0]._s(e);return s.update("(1.0/("+s.s+"))")}if(this[1]instanceof o.Rational){this[1]=this[1].reduce();var y=this[1].a%2?!1:!0;if(y){var n=this[1]._s(e),s=this[0]._s(e);return s.merge(n,"pow("+s.s+","+n.s+")")}var n=this[1]["-"](_.One)._s(e),s=this[0].s_(e);return s.merge(n,"(("+s.s+") * pow("+s.s+","+n.s+"))")}if(this[0]instanceof o.NumericalReal){var n=this[1]["-"](_.One)._s(e),s=this[0]._s(e);return s.merge(n,"(("+s.s+") * pow("+s.s+","+n.s+"))")}var n=this[1]["-"](_.One)._s(e),s=this[0]._s(e);return s.merge(n,"(("+s.s+") * pow("+s.s+","+n.s+"))")}if("text/javascript"===e){if(this[0]===_.e){var n=this[1]._s(e);return n.update("Math.exp("+n.s+")")}if(this[1]instanceof o.Rational){var y=this[1].a%2?!1:!0;if(y){var n=this[1]._s(e),s=this[0]._s(e);return s.merge(n,"Math.pow("+s.s+","+n.s+")")}var n=this[1]._s(e),s=this[0]._s(e);return s.merge(n,"Math.pow("+s.s+","+n.s+")")}var n=this[1]._s(e),s=this[0]._s(e);return s.merge(n,"Math.pow("+s.s+","+n.s+")")}if("text/latex"===e){var s=this[0]._s(e),n=this[1]._s(e);return s.merge(n,r(s)+"^"+"{"+n.s+"}")}}var s=this[0]._s(e);if("@"===this.operator[0])return s.update(this.operator[1]+r(s),h);var n=this[1]._s(e);if("text/latex"===e){if("/"===this.operator)return s.merge(n,"\\frac{"+s.s+"}{"+n.s+"}");if("*"===this.operator)return s.merge(n,r(s)+r(n),h)}else if("x-shader/x-fragment"===e&&"%"===this.operator)return s.merge(n,"mod("+r(s)+","+r(n)+")",h);return s.merge(n,r(s)+this.operator+r(n),h)},o.Statement.prototype._s=o.List.Real.prototype.s,o.Symbol.prototype._s=function(){return new m(this.symbol||"x_{free}")},o.NumericalReal.prototype._s=function(t){if("x-shader/x-fragment"===t){var e=this.value.toExponential();return-1===e.indexOf(".")&&(e=e.replace("e",".e")),new m(e)}return new m(""+this.value)},o.List.ComplexPolar.prototype._s=function(t){function e(t,e){return e>t.p?"\\left("+t.s+"\\right)":t.s}if("text/latex"!==t)throw"Exporting not supported for complex values.";N.precedence("+");var i=N.precedence("*"),r=this[0]._s(t),n=this[1]._s(t);return r.merge(n,e(r,i)+""+"e^{i"+e(n,i))},o.List.ComplexCartesian.prototype._s=function(t){function e(t,e){return e>t.p?"\\left("+t.s+"\\right)":t.s}if("text/latex"!==t)throw"Exporting not supported for complex values.";var i=N.precedence("+"),r=this[0]._s(t),n=this[1]._s(t);return r.merge(n,e(r)+"+"+e(n,i)+"i",N.precedence("+"))},o.NumericalComplex.prototype._s=function(t){if(i("NumericalComplex.toTypedString????"),"text/latex"===t){var e=this.realimag();return 0===this._real?1===this._imag?new m("i"):-1===this._imag?new m("-i"):new m(e[1]._s(N).s+"i"):0===this._imag?new m(e[0]._s(N).s):1===this._imag?new m(e[0]._s(N).s+" + i"):-1===this._imag?new m(e[0]._s(N).s+" - i"):0>this._imag?new m(e[0]._s(N).s+" + "+e[1]._s(N).s+"i"):new m(e[0]+" + "+e[1]._s(N).s+"i")}throw"Please use x.realimag()[0 /* or 1 */].toTypedString() to generate code."},o.Integer.prototype._s=function(t){return"x-shader/x-fragment"===t?new m(""+this.a+".0"):new m(""+this.a)},o.Vector.prototype._s=function(t){var e=this.length,i="[",r="]";"x-shader/x-fragment"===t&&(i="vec"+this.length+"(",r=")");var n,s=this[0]._s(t),a=[];for(n=0;e>n;n++){var o=this[n]._s(t);a.push(o.s),s=s.merge(o)}return s.update(i+a.join(",")+r,1/0)},o.Statement.prototype._s=function(t){function e(t){return i>t.p?paren(t.s):t.s}var i=N.precedence(this.operator),r=this[0]._s(t),n=this[1]._s(t);return r.merge(n,e(r)+this.operator+e(n),i)},o.True._s=function(){return new m("true")},o.False._s=function(){return new m("false")},o.prototype.s=function(t){return m.newContext(),this._s(t)},o.prototype.compile=function(t){return this.s("text/javascript").compile(t)},o.prototype.glslFunction=function(t,e,i){return this.s("x-shader/x-fragment").glslFunction(t,e,i)},o.Numerical=o.Complex;var k=new o.Function({"default":function(t){if(t instanceof o.NumericalReal||t instanceof o.List.Real||t instanceof o.Symbol.Real)return new y.Expression.List.ComplexCartesian([_.sin.default(t),_.Zero]);throw Error("Complex Sine Cartesian form not implemented yet.")}});_.sin=new o.Function({"default":function(t){return t instanceof o.NumericalReal?new o.NumericalReal(Math.sin(t.value)):t instanceof o.List.Real||t instanceof o.Symbol.Real?o.List.Real([_.sin,t]):o.List([_.sin,t])},realimag:function(){return k},"text/latex":"\\sin","text/javascript":"Math.sin","x-shader/x-fragment":"sin",title:"Sine Function",description:"See http://en.wikipedia.org/wiki/Trigonometric_functions#Sine.2C_cosine.2C_and_tangent",examples:["\\sin (\\pi)"],related:["cos","tan"]}),_.cos=new o.Function({"default":function(t){return t instanceof o.NumericalReal?new o.NumericalReal(Math.cos(t.value)):t instanceof o.List.Real||t instanceof o.Symbol.Real?o.List.Real([_.cos,t]):o.List([_.cos,t])},derivative:_.sin["@-"](),"text/latex":"\\cos","text/javascript":"Math.cos","x-shader/x-fragment":"cos",title:"Cosine Function",description:"Cosine Function desc",examples:["\\cos (\\pi)"],related:["sin","tan"]}),_.sin.derivative=_.cos,_.tan=new o.Function({symbolic:function(){}}),_.log=new o.Function({"default":function(t,e){if(t instanceof o.Integer&&1===t.a)return _.Zero;if(t instanceof o.Integer&&0===t.a)return _.Infinity["@-"]();if(t instanceof o.NumericalReal){var i=t.value;if(i>0)return new o.NumericalReal(Math.log(i))}return e&&e.positive?o.List.Real([_.log,t]):o.List([_.log,t])},realimag:function(){return E},"text/latex":"\\log","text/javascript":"Math.log","x-shader/x-fragment":"log",title:"Natural Logarithm",description:"Base e. See http://en.wikipedia.org/wiki/Natural_logarithm",examples:["\\log (ye^(2x))"],related:["exp","Log"]});var O=new o.Rational(1,2),E=new o.Function({"default":function(t){return new o.List.ComplexCartesian([_.log.default(t.abs()),t.arg()])["*"](O)}});E.__proto__=_.log,_.atan2=new o.Function({"default":function(t){if(!(t instanceof o.Vector))throw"atan only takes vector arguments";return t[0]instanceof o.NumericalReal&&t[1]instanceof o.NumericalReal?new o.NumericalReal(Math.atan2(t[0].value,t[1].value)):new o.List.Real([_.atan2,t])},apply_realimag:function(t,e){return[o.List([_.atan2,e]),y.Global.Zero]},"text/latex":"\\tan^{-1}","text/javascript":"Math.atan2","x-shader/x-fragment":"atan",toTypedString:function(t){return{s:this[t],t:I.Function}},title:"Two argument arctangent function",description:"Arctan(y, x). Will equal arctan(y / x) except when x and y are both negative. See http://en.wikipedia.org/wiki/Atan2"}),_.atan=_.atan2,_.Gamma={"default":function(t){function e(t){var e,i,r,n,s,a=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(0>=t)throw"bad arg in gammln";for(n=i=t,r=i+5.2421875,r=(i+.5)*Math.log(r)-r,s=.9999999999999971,e=0;14>e;e++)s+=a[e]/++n;return r+Math.log(2.5066282746310007*s/i)}if(t instanceof o.Integer){var i=t.a;if(0>i)return _.ComplexInfinity;if(15>i){var r=1,n=0;for(n=1;i>n;n++)r*=n;return new o.Integer(r)}return o.List.Real([_.Gamma,t])}if(t instanceof o.NumericalReal){var i=t.value;return 0===i?_.Infinity:0>i?new o.NumericalReal(-Math.PI/(i*Math.sin(Math.PI*i)*Math.exp(e(-i)))):new o.NumericalReal(Math.exp(e(i)))}return t instanceof o.NumericalComplex,o.List([_.Gamma,t])},"text/latex":"\\Gamma","text/javascript":"M.Global.Gamma.f",toTypedString:function(t){return{s:this[t],t:I.Function}},title:"Gamma Function",description:"See http://en.wikipedia.org/wiki/Gamma_function",examples:["\\Gamma (x)","x!"],related:["Log","LogGamma"]},_.Re={"default":function(t){return t.real()},apply_realimag:function(t,e){return[e.real(),_.Zero]},"text/latex":"\\Re"},_.Im={"default":function(t){return t.imag()},distributed_under_differentiation:!0,apply_realimag:function(t,e){return[e.imag(),_.Zero]},"text/latex":"\\Im"},o.List.Real.prototype.positive=function(){if("+"===this.operator)return this[0].positive&&this[1].positive&&this[0].positive()&&this[1].positive();if("*"===this.operator)return this[0]===this[1]?!0:this[0].positive&&this[1].positive&&this[0].positive()&&this[1].positive();if("^"===this.operator&&this[1]instanceof o.Rational){var t=this[1].reduce();if(0===t.a%2)return!0}return!1},o.NumericalReal.prototype.positive=function(){return this.value>0},_.sqrt=new o.Function({"default":function(t){if(t instanceof o.NumericalReal){var e=t.value;return 0>e?new o.List.ComplexCartesian([_.Zero,new o.NumericalReal(Math.sqrt(e))]):new o.NumericalReal(Math.sqrt(e))}return t instanceof o.List.Real?t.positive()?o.List.Real([_.sqrt,t]):o.List([_.sqrt,t]):t instanceof o.List.ComplexPolar?new o.List.ComplexPolar([t[0],t[1]["/"](new o.Integer(2))]):t instanceof o.List.ComplexCartesian?new o.List([_.sqrt,t]):o.List([_.sqrt,t])},apply_realimag:function(t,e){return e["^"](new o.Rational(1,2)).realimag()},"text/latex":"\\sqrt","text/javascript":"Math.sqrt","x-shader/x-fragment":"sqrt",toTypedString:function(t){return{s:this[t],t:I.Function}},title:"Sqrt Function",description:"See http://en.wikipedia.org/wiki/Square_Root",examples:["\\sqrt (x^4)"],related:["pow","abs","mod"]}),_.abs=new o.Function({"default":function(t){return t.abs()},"text/latex":"\\abs","text/javascript":"Math.abs","x-shader/x-fragment":"abs",titie:"Absolute Value Function",description:"Abs",examples:["\\abs (-3)","\\abs (i+3)"],related:["arg","tan"]}),_.abs.derivative=function(){var t=new o.Symbol.Real,e=t["/"](t.abs());return new o.Function.Symbolic(e,[t])}(),_.arg={"default":function(t){return console.warn("ARG IS FOR USER INPUT ONLY. USE .arg()"),t.arg()},"text/latex":"\\arg","text/javascript":"Math.arg_real",toTypedString:function(t){return{s:this[t],t:I.Function}},titie:"Arg Function",description:"Arg",examples:["\\arg (-3)","\\arg (3)","\\arg(3+2i)"],related:["abs"]},_.e=new o.NumericalReal(Math.E,0),_.e.title="e",_.e.description="The transcendental number that is the base of the natural logarithm, approximately equal to 2.71828.",_.e.s=function(t){return"text/javascript"===t?new m("Math.E"):"text/latex"==t?new m("e"):new m("2.718281828459045")},_.pi=new o.NumericalReal(Math.PI,0),_.pi.title="Pi",_.pi.description="",_.pi.s=function(t){return"text/javascript"===t?new m("Math.PI"):"text/latex"===t?new m("\\pi"):new m("3.141592653589793")},_.tau=_.pi["*"](new o.Integer(2)),_.Infinity=new o.NumericalReal(1/0,0),_.Infinity.title="Infinity",_.Infinity.description="",_.infty=_.Infinity,_.Zero=new o.Integer(0),_.Zero.title="Zero",_.Zero.description="Additive Identity",_.Zero["*"]=function(){return _.Zero},_.Zero["+"]=function(t){return t},_.Zero["@-"]=function(){return this},_.Zero["-"]=function(t){return t["@-"]()},_.One=new o.Integer(1),_.One.title="One",_.One.description="Multiplicative Identity",_.One["*"]=function(t){return t},_.log.derivative=new o.Function.Symbolic(_.One["/"](new o.Symbol.Real)),_.i=new o.List.ComplexCartesian([_.Zero,_.One]),_.i.title="Imaginary Unit",_.i.description="A number which satisfies the property <m>i^2 = -1</m>.",_.i.realimag=function(){return o.List.ComplexCartesian([_.Zero,_.One])},_.i["*[TODO]"]=function(){},_.d=new o.Function({"default":function(t){return new f(t)}}),_.d["/"]=function(t){if(t instanceof f){if(t.x instanceof o.Symbol)return new p(t.x);if(t.x instanceof o.Vector)return o.Vector(Array.prototype.map.call(t.x,function(t){return new p(t)}));throw"Confusing infitesimal division"}throw"Dividing d by some large number."},_.undefined={s:function(e){return"text/javascript"===e?new m("undefined"):"x-shader/x-fragment"===e?new m("(1.0/0.0)"):t},differentiate:function(){return this},"*":function(){return this},"+":function(){return this},"-":function(){return this},"/":function(){return this},"^":function(){return this},"@-":function(){return this}},_.sum=new o.Function({"default":function(){throw"Sum not properly constructed yet."}}),_.sum._=function(t){var e=t[0],i=t[1];return new o.Sum.Real(e,i)},y.toString=function(){return"function M(expression, context) {\n    /*!\n     *  Math JavaScript Library v3.9.1\n     *  https://github.com/aantthony/javascript-cas\n     *  \n     *  Copyright 2010 Anthony Foster. All rights reserved.\n     */\n    [awesome code]\n}"},y.Context=s,y.Expression=o,y.Global=_,y.Error=r;var Z={};y.register=function(t,e){if(o.prototype[t])throw"Method ."+t+" is already in use!";Z[t]=e},y.load=function(t,e){Z[t](y,o,e),delete Z[t]},"undefined"!=typeof module?module.exports=y:window.M=y,console.log("Load time:",new Date-w,"ms")})();